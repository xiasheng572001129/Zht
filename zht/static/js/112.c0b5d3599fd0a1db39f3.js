webpackJsonp([112],{"+aiy":function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n.region[data-v-5d968408] {\r\n  max-height: 400px;\r\n  overflow: auto;\n}\n.province[data-v-5d968408] {\r\n  padding: 20px 0;\n}\n.city[data-v-5d968408] {\r\n  padding: 5px 10px;\r\n  border-top: 1px solid #cccccc;\n}\n.area[data-v-5d968408] {\r\n  padding: 1px 15px;\n}\n.export[data-v-5d968408] {\r\n  float: right;\r\n\r\n  margin-right: 70px;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/filterIncome/src/pages/filterIncome/index.vue"],names:[],mappings:";AAkTA;EACA,kBAAA;EACA,eAAA;CACA;AACA;EACA,gBAAA;CACA;AACA;EACA,kBAAA;EACA,8BAAA;CACA;AACA;EACA,kBAAA;CACA;AACA;EACA,aAAA;;EAEA,mBAAA;CACA",file:"index.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele">\r\n          <i></i>\r\n          配送中心-滤芯收入\r\n          <div class=\'export\'>\r\n            <el-button type="primary"\r\n                       @click="EXPort()">导出</el-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \x3c!-- 省市搜索 --\x3e\r\n      <div style="margin-left:30px">\r\n\r\n        \x3c!-- <el-input v-model="company"\r\n                  placeholder="请输入公司名称"\r\n                  style="width:15%"\r\n                  clearable /> --\x3e\r\n        <el-select placeholder="请选择省"\r\n                   v-model="provinceId"\r\n                   @change="getCity"\r\n                   clearable>\r\n          <el-option v-for="(item,index) in provinceList"\r\n                     :key="index"\r\n                     :label="item.name"\r\n                     :value="item.id"></el-option>\r\n        </el-select>\r\n        <el-select placeholder="请选择市"\r\n                   v-model="cityId"\r\n                   @change="init()">\r\n          <el-option v-for="(item,index) in cityList"\r\n                     :key="index"\r\n                     :label="item.name"\r\n                     :value="item.id"></el-option>\r\n        </el-select>\r\n        <el-date-picker type="month"\r\n                        placeholder="选择月份"\r\n                        v-model="month"\r\n                        @change="search"\r\n                        value-format="yyyy-MM-dd">\r\n        </el-date-picker>\r\n      </div>\r\n      \x3c!-- 列表 --\x3e\r\n      <el-table :data="list">\r\n        <el-table-column align="center"\r\n                         label="运营中心名称">\r\n          <template slot-scope="scope">\r\n            {{`${scope.row.province}${scope.row.city}`}}<span v-if="scope.row.province">运营中心</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="滤芯补贴收入"\r\n                         prop="total_money">\r\n          <template slot-scope="scope">\r\n            <el-button type="text"\r\n                       @click="incomeDetail(scope.row)">{{scope.row.total_money}}</el-button>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="月份"\r\n                         prop="month">\r\n          <template slot-scope="scope">\r\n            <div v-if="scope.row.month">\r\n              {{scope.row.month}}月\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      \x3c!-- 地区详情 --\x3e\r\n      <el-dialog title="地区详情"\r\n                 :visible.sync="regionDetailsVisible"\r\n                 center>\r\n        <div v-if="regionList && regionList.length>0"\r\n             class="region">\r\n          <div v-for="(item,index) in regionList"\r\n               class="province"\r\n               :key="index">\r\n            <h3 style="margin:5px 0">{{item.name}}</h3>\r\n            <div v-if="item.son && item.son.length>0">\r\n              <div v-for="(city,cityIndex) in item.son"\r\n                   :key="cityIndex"\r\n                   class="city">\r\n                <h4>{{city.name}}</h4>\r\n                <div v-if="city.son && city.son.length>0">\r\n                  <div v-for="(area,areaIndex) in city.son"\r\n                       :key="areaIndex"\r\n                       class="area">\r\n                    {{area.name}}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </el-dialog>\r\n      \x3c!-- 收入明细 --\x3e\r\n      <el-dialog title="收入明细"\r\n                 center\r\n                 :visible.sync="incomeVisible">\r\n        <el-table :data="incomeList">\r\n          <el-table-column align="center"\r\n                           label="维修厂名称"\r\n                           prop="company">\r\n\r\n          </el-table-column>\r\n          <el-table-column align="center"\r\n                           label="邦保养卡号"\r\n                           prop="card_number"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="车牌号"\r\n                           prop="plate"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="收入金额( 元 )"\r\n                           prop="money"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="收入时间"\r\n                           prop="create_time"></el-table-column>\r\n        </el-table>\r\n        \x3c!-- 收入明细分页 --\x3e\r\n        <div class="page_center">\r\n          <paging :page-count="incomeCount"\r\n                  :page="incomePage"\r\n                  @index="(e)=>{\r\n                    incomePage=e,\r\n                    incomeDetail(currentIncomeData)\r\n                }"></paging>\r\n        </div>\r\n      </el-dialog>\r\n      \x3c!-- 分页 --\x3e\r\n      <div :class="list && list.length<=7?\'page-nav\':\'page_center\'"\r\n           v-show="list && list.length>0">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n        \x3c!--分页的组件--\x3e\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script type="text/ecmascript-6">\r\nimport { getPro, GET_City } from \'@/utils\'   //获取省市\r\nexport default {\r\n  data () {\r\n    return {\r\n      list: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      //分页数据\r\n      page: 1, //显示的页码数\r\n      pageCount: 1,\r\n      curId: 0,\r\n      thCurId: 0,\r\n      seCurId: 0,\r\n      threeAuthList: [],\r\n      authList: [],\r\n      regionDetailsVisible: false, //地区详情弹框状态\r\n      detailsPage: 1,    //复核详情当前页数\r\n      detailsCount: 1,  //复核详情总页数\r\n      detailsList: [],  //复核详情列表\r\n      currentReviewData: {}, //当前复核详情\r\n      phone: \'\', // 负责人联系电话\r\n      throughLoading: [],\r\n      incomeVisible: false, //提现明细弹框状态\r\n      incomePage: 1, //收入明细当前页\r\n      incomeCount: 1, //收入明细总页数\r\n      incomeList: [], //收入明细列表,\r\n      currentIncomeData: {}, //当前收入明细详情\r\n      provinceList: [],//所有省列表\r\n      provinceId: \'\',//当前所选中的省id\r\n      cityList: [], //市列表\r\n      cityId: \'\',//当前选中的市id\r\n      company: "", //公司名称\r\n      regionList: [], //地区列表\r\n      month: "", //月份\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    dateTime () {\r\n\r\n      const dateTime = new Date(this.month)\r\n      const year = dateTime.getFullYear()\r\n      const month = dateTime.getMonth() + 1\r\n      return this.month ? `${year}-${month}` : \'\'\r\n    }\r\n  },\r\n  watch: {\r\n    company (val) {\r\n      this.page = 1\r\n      this.init()\r\n    }\r\n  },\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    init () {\r\n      this.$axios.post(\'admin/AgentIncome/index\', { token: this.token, page: this.page, city: this.cityId, month: this.dateTime })\r\n        .then(res => {\r\n          this.list = res.data.data.list;\r\n          this.pageCount = res.data.data.rows || 1;\r\n        }).catch(err => { })\r\n    },\r\n    search (time) {\r\n      this.page = 1;\r\n      this.init()\r\n    },\r\n    //地区详情\r\n    async regionDetails (item) {\r\n      try {\r\n        this.regionDetailsVisible = true\r\n        const res = await this.$axios.post(\'admin/AgentList/regionList\', { token: this.token, aid: item.aid })\r\n        this.regionList = res.data.data || []\r\n\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    // 收入明细\r\n    async incomeDetail (item) {\r\n      try {\r\n        this.incomeVisible = true\r\n        const res = await this.$axios.post(\'admin/AgentIncome/filterDetail\', { token: this.token, page: this.incomePage, month: this.dateTime, city_id: item.city_id })\r\n        console.log(res.data.data.list)\r\n        this.incomeList = res.data.data.list || []\r\n        this.incomeCount = res.data.data.rows || 1\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n\r\n\r\n    // 获取省\r\n    async getProList () {\r\n      try {\r\n        const data = await getPro()\r\n        this.provinceList = data || []\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n\r\n    //获取市\r\n    async getCity () {\r\n      try {\r\n        const data = await GET_City(this.provinceId)\r\n        this.cityList = data || []\r\n        this.cityId = this.provinceId && data[0].id\r\n        this.init()\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    //导出\r\n    EXPort () {\r\n      window.location.href = `${this.baseURL}admin/Login/agentFilter?city=${this.cityId}&month=${this.dateTime}`\r\n    },\r\n    Auth () {  //权限列表\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: window.sessionStorage.getItem(\'bbytoken\'),\r\n        id: id\r\n      })\r\n        .then(res => {\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].son) {\r\n                if (arr[i].name == \'滤芯收入\') {\r\n                  this.seCurId = arr[i].id;\r\n                  this.threeAuthList = arr[i].son;\r\n                }\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.Auth()\r\n    this.init()\r\n    this.getProList()\r\n  },\r\n}\r\n<\/script>\r\n<style scoped>\r\n.region {\r\n  max-height: 400px;\r\n  overflow: auto;\r\n}\r\n.province {\r\n  padding: 20px 0;\r\n}\r\n.city {\r\n  padding: 5px 10px;\r\n  border-top: 1px solid #cccccc;\r\n}\r\n.area {\r\n  padding: 1px 15px;\r\n}\r\n.export {\r\n  float: right;\r\n\r\n  margin-right: 70px;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},Xpol:function(n,e,t){var r=t("+aiy");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);t("rjj0")("ef0c3d54",r,!1,{})},"zwk/":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("Xxa5"),i=t.n(r),a=t("exGp"),o=t.n(a),s=t("0xDb"),c={data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,curId:0,thCurId:0,seCurId:0,threeAuthList:[],authList:[],regionDetailsVisible:!1,detailsPage:1,detailsCount:1,detailsList:[],currentReviewData:{},phone:"",throughLoading:[],incomeVisible:!1,incomePage:1,incomeCount:1,incomeList:[],currentIncomeData:{},provinceList:[],provinceId:"",cityList:[],cityId:"",company:"",regionList:[],month:""}},computed:{dateTime:function(){var n=new Date(this.month),e=n.getFullYear(),t=n.getMonth()+1;return this.month?e+"-"+t:""}},watch:{company:function(n){this.page=1,this.init()}},methods:{paging:function(n){this.page=n,this.init()},init:function(){var n=this;this.$axios.post("admin/AgentIncome/index",{token:this.token,page:this.page,city:this.cityId,month:this.dateTime}).then(function(e){n.list=e.data.data.list,n.pageCount=e.data.data.rows||1}).catch(function(n){})},search:function(n){this.page=1,this.init()},regionDetails:function(n){var e=this;return o()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.regionDetailsVisible=!0,t.next=4,e.$axios.post("admin/AgentList/regionList",{token:e.token,aid:n.aid});case 4:r=t.sent,e.regionList=r.data.data||[],t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},incomeDetail:function(n){var e=this;return o()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.incomeVisible=!0,t.next=4,e.$axios.post("admin/AgentIncome/filterDetail",{token:e.token,page:e.incomePage,month:e.dateTime,city_id:n.city_id});case 4:r=t.sent,console.log(r.data.data.list),e.incomeList=r.data.data.list||[],e.incomeCount=r.data.data.rows||1,t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(0),t.t0;case 13:case"end":return t.stop()}},t,e,[[0,10]])}))()},getProList:function(){var n=this;return o()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.c)();case 3:t=e.sent,n.provinceList=t||[],e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,n,[[0,7]])}))()},getCity:function(){var n=this;return o()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.b)(n.provinceId);case 3:t=e.sent,n.cityList=t||[],n.cityId=n.provinceId&&t[0].id,n.init(),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,n,[[0,9]])}))()},EXPort:function(){window.location.href=this.baseURL+"admin/Login/agentFilter?city="+this.cityId+"&month="+this.dateTime},Auth:function(){var n=this,e=this.$route.query.id;this.curId=e,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:e}).then(function(e){if(1==e.data.code){for(var t=e.data.data,r=0;r<t.length;r++)t[r].son&&"滤芯收入"==t[r].name&&(n.seCurId=t[r].id,n.threeAuthList=t[r].son);n.authList=t}else n.$alert(e.data.msg,"提示",{type:"error"})}).catch(function(n){alert(n)})}},mounted:function(){this.Auth(),this.init(),this.getProList()}},l=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",[t("ctbHead",n._l(n.authList,function(e){return t("router-link",{key:e.id,class:n.seCurId==e.id?"cur":"",attrs:{to:{path:e.action,query:{id:n.curId}},"v-key":e.id}},[n._v("\n      "+n._s(e.name)+"\n    ")])}),1),n._v(" "),t("div",{staticClass:"container"},[t("div",{staticClass:"quote"},[t("div",{staticClass:"quote-ele"},[t("i"),n._v("\n        配送中心-滤芯收入\n        "),t("div",{staticClass:"export"},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){return n.EXPort()}}},[n._v("导出")])],1)])]),n._v(" "),t("div",{staticStyle:{"margin-left":"30px"}},[t("el-select",{attrs:{placeholder:"请选择省",clearable:""},on:{change:n.getCity},model:{value:n.provinceId,callback:function(e){n.provinceId=e},expression:"provinceId"}},n._l(n.provinceList,function(n,e){return t("el-option",{key:e,attrs:{label:n.name,value:n.id}})}),1),n._v(" "),t("el-select",{attrs:{placeholder:"请选择市"},on:{change:function(e){return n.init()}},model:{value:n.cityId,callback:function(e){n.cityId=e},expression:"cityId"}},n._l(n.cityList,function(n,e){return t("el-option",{key:e,attrs:{label:n.name,value:n.id}})}),1),n._v(" "),t("el-date-picker",{attrs:{type:"month",placeholder:"选择月份","value-format":"yyyy-MM-dd"},on:{change:n.search},model:{value:n.month,callback:function(e){n.month=e},expression:"month"}})],1),n._v(" "),t("el-table",{attrs:{data:n.list}},[t("el-table-column",{attrs:{align:"center",label:"运营中心名称"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n          "+n._s(""+e.row.province+e.row.city)),e.row.province?t("span",[n._v("运营中心")]):n._e()]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"滤芯补贴收入",prop:"total_money"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return n.incomeDetail(e.row)}}},[n._v(n._s(e.row.total_money))])]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"月份",prop:"month"},scopedSlots:n._u([{key:"default",fn:function(e){return[e.row.month?t("div",[n._v("\n            "+n._s(e.row.month)+"月\n          ")]):n._e()]}}])})],1),n._v(" "),t("el-dialog",{attrs:{title:"地区详情",visible:n.regionDetailsVisible,center:""},on:{"update:visible":function(e){n.regionDetailsVisible=e}}},[n.regionList&&n.regionList.length>0?t("div",{staticClass:"region"},n._l(n.regionList,function(e,r){return t("div",{key:r,staticClass:"province"},[t("h3",{staticStyle:{margin:"5px 0"}},[n._v(n._s(e.name))]),n._v(" "),e.son&&e.son.length>0?t("div",n._l(e.son,function(e,r){return t("div",{key:r,staticClass:"city"},[t("h4",[n._v(n._s(e.name))]),n._v(" "),e.son&&e.son.length>0?t("div",n._l(e.son,function(e,r){return t("div",{key:r,staticClass:"area"},[n._v("\n                  "+n._s(e.name)+"\n                ")])}),0):n._e()])}),0):n._e()])}),0):n._e()]),n._v(" "),t("el-dialog",{attrs:{title:"收入明细",center:"",visible:n.incomeVisible},on:{"update:visible":function(e){n.incomeVisible=e}}},[t("el-table",{attrs:{data:n.incomeList}},[t("el-table-column",{attrs:{align:"center",label:"维修厂名称",prop:"company"}}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"邦保养卡号",prop:"card_number"}}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"车牌号",prop:"plate"}}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"收入金额( 元 )",prop:"money"}}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:"收入时间",prop:"create_time"}})],1),n._v(" "),t("div",{staticClass:"page_center"},[t("paging",{attrs:{"page-count":n.incomeCount,page:n.incomePage},on:{index:function(e){n.incomePage=e,n.incomeDetail(n.currentIncomeData)}}})],1)],1),n._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:n.list&&n.list.length>0,expression:"list && list.length>0"}],class:n.list&&n.list.length<=7?"page-nav":"page_center"},[t("paging",{attrs:{"page-count":n.pageCount,page:n.page},on:{index:n.paging}})],1)],1)],1)};l._withStripped=!0;var d={render:l,staticRenderFns:[]},p=d;var u=!1;var m=t("VU/8")(c,p,!1,function(n){u||t("Xpol")},"data-v-5d968408",null);m.options.__file="src/pages/filterIncome/index.vue";e.default=m.exports}});
//# sourceMappingURL=112.c0b5d3599fd0a1db39f3.js.map
webpackJsonp([113],{ajxx:function(e,n,t){(e.exports=t("FZ+f")(!0)).push([e.i,"\n.ellipsis[data-v-5d664aee] {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\n}\n.areaDetails[data-v-5d664aee] {\r\n  max-height: 300px;\r\n  min-height: 100px;\r\n  overflow: auto;\n}\n.areaDetails .area[data-v-5d664aee] {\r\n  padding: 10px 0;\r\n  border-bottom: 1px solid #cccccc;\n}\n.areaDetails .province[data-v-5d664aee] {\r\n  font-size: 15px;\r\n  font-weight: 600;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/channelIssuing/list/src/pages/channelIssuing/list/index.vue"],names:[],mappings:";AA4XA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA;AACA;EACA,kBAAA;EACA,kBAAA;EACA,eAAA;CACA;AACA;EACA,gBAAA;EACA,iCAAA;CACA;AACA;EACA,gBAAA;EACA,iBAAA;CACA",file:"index.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele">\r\n          <i></i>\r\n          渠道发卡-发卡列表\r\n          <el-button type="primary"\r\n                     @click="Export()"\r\n                     style="float:right;margin:20px 40px 0 0">导出</el-button>\r\n        </div>\r\n        <div class="quote-nav">\r\n          <router-link :class="thCurId==item.id? \'cur\':\'\'"\r\n                       v-for="item in threeAuthList"\r\n                       :key="item.id"\r\n                       :to="{path:item.action,query:{id:curId}}">\r\n            {{item.name}}\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n      \x3c!-- 省市搜索 --\x3e\r\n      \x3c!-- <div style="margin-left:30px">\r\n        <el-select placeholder="请选择省"\r\n                   v-model="provinceId"\r\n                   @change="getCity">\r\n          <el-option v-for="(item,index) in provinceList"\r\n                     :key="index"\r\n                     :label="item.name"\r\n                     :value="item.id"></el-option>\r\n        </el-select>\r\n        <el-select placeholder="请选择市"\r\n                   v-model="cityId"\r\n                   @change="init()">\r\n          <el-option v-for="(item,index) in cityList"\r\n                     :key="index"\r\n                     :label="item.name"\r\n                     :value="item.id"></el-option>\r\n        </el-select>\r\n      </div> --\x3e\r\n      \x3c!-- 列表 --\x3e\r\n      <div>\r\n        <el-col :span="5"\r\n                :offset=\'1\'\r\n                style="margin-right:10px">\r\n          \x3c!-- <el-input placeholder="请输入渠道名称"\r\n                    v-model="company" /> --\x3e\r\n          <el-select placeholder="请选择省"\r\n                     v-model="provinceId"\r\n                     @change="getCity"\r\n                     clearable>\r\n            <el-option v-for="(item,index) in provinceList"\r\n                       :key="index"\r\n                       :label="item.name"\r\n                       :value="item.id"></el-option>\r\n          </el-select>\r\n          <el-select placeholder="请选择市"\r\n                     v-model="cityId"\r\n                     @change="init()">\r\n            <el-option v-for="(item,index) in cityList"\r\n                       :key="index"\r\n                       :label="item.name"\r\n                       :value="item.id"></el-option>\r\n          </el-select>\r\n        </el-col>\r\n\r\n        <el-col :span="10">\r\n\r\n          <el-date-picker type="month"\r\n                          placeholder="选择月份"\r\n                          v-model="month"\r\n                          @change="search"\r\n                          value-format="yyyy-MM-dd">\r\n          </el-date-picker>\r\n        </el-col>\r\n      </div>\r\n      <el-table :data="list">\r\n        <el-table-column prop="company"\r\n                         label="运营中心名称"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <div v-if="scope.row.province_name">\r\n              {{`${scope.row.province_name}${scope.row.city_name}运营中心`}}\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop="shop_count"\r\n                         label="维修厂数量"\r\n                         align="center">\r\n        </el-table-column>\r\n        <el-table-column prop="card_num"\r\n                         label="卡总数"\r\n                         align="center">\r\n        </el-table-column>\r\n        <el-table-column prop="consume_num"\r\n                         label="消耗数量"\r\n                         align="center">\r\n        </el-table-column>\r\n        <el-table-column prop="supp"\r\n                         label="补卡数量"\r\n                         align="center">\r\n        </el-table-column>\r\n        <el-table-column prop="sur_num"\r\n                         label="剩余数量"\r\n                         align="center">\r\n        </el-table-column>\r\n\r\n        \x3c!-- <el-table-column align="center"\r\n                         label="地区">\r\n          <template slot-scope="scope">\r\n            <el-popover placement="bottom"\r\n                        width="400"\r\n                        trigger="click">\r\n              <el-button type="text"\r\n                         slot="reference">详情</el-button>\r\n              <div class="areaDetails">\r\n                <h4 style="text-align:center">地区详情</h4>\r\n                <div v-if="scope.row.province">\r\n                  <span style="float:left;width:80%;">\r\n                    <div v-for="(item,index) in scope.row.province"\r\n                         :key="index"\r\n                         class="area">\r\n                      <p class="province"> {{item.province_name}}</p>\r\n                      <p class="city">{{item.city_name ? item.city_name.join(\'、\') : \'\'}}</p>\r\n                    </div>\r\n                  </span>\r\n                </div>\r\n                <div v-else\r\n                     style="text-align:center;line-height:100px;font-size:18px">\r\n                  无\r\n                </div>\r\n              </div>\r\n            </el-popover>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label="详细地址"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-popover placement="top-start"\r\n                        width="200"\r\n                        trigger="hover"\r\n                        :content="`${scope.row.province_name}${scope.row.city}${scope.row.county}${scope.row.address}`">\r\n              <el-button slot="reference"\r\n                         type="text"\r\n                         class="ellipsis">{{`${scope.row.province_name}${scope.row.city}${scope.row.county}${scope.row.address}`}}</el-button>\r\n            </el-popover>\r\n\r\n          </template>\r\n        </el-table-column> --\x3e\r\n\r\n        <el-table-column label="操作"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-button type="info"\r\n                       size="mini"\r\n                       @click="details(scope.row)">详情</el-button>\r\n\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      \x3c!-- 复核详情 --\x3e\r\n      <el-dialog title="复核详情"\r\n                 :visible.sync="detailsVisible"\r\n                 center\r\n                 width="70%"\r\n                 @close=\'()=>{detailsPage=1}\'>\r\n        <el-table :data="detailsList">\r\n          <el-table-column align="center"\r\n                           label="维修厂名称"\r\n                           prop="company"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="消耗数量"\r\n                           prop="policy_count"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="新增">\r\n            <template slot-scope="scope">\r\n              {{scope.row.new ? `${dateTime}月份${scope.row.new}` : \'\'}}\r\n            </template>\r\n          </el-table-column>\r\n          \x3c!-- <el-table-column align="center"\r\n                           label="维修厂电话"\r\n                           min-width="100px"\r\n                           prop="shop_phone"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="车辆品牌"\r\n                           prop="car_name"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="车辆类型"\r\n                           prop="type"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="排量"\r\n                           prop="series"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="车牌号"\r\n                           prop="plate"\r\n                           min-width="100px"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="参与时间"\r\n                           prop="sale_time"></el-table-column>\r\n          <el-table-column align="center"\r\n                           label="审核时间"\r\n                           prop="audit_time">\r\n            <template slot-scope="scope">\r\n              {{scope.row.audit_time | datetime}}\r\n            </template>\r\n          </el-table-column> --\x3e\r\n\r\n        </el-table>\r\n        \x3c!-- 详情分页 --\x3e\r\n        <div class="page_center">\r\n          <paging :page-count="detailsCount"\r\n                  :page="detailsPage"\r\n                  @index="(e)=>{\r\n                    detailsPage=e,\r\n                    details(currentReviewData)\r\n                }"></paging>\r\n        </div>\r\n\r\n      </el-dialog>\r\n\r\n      \x3c!-- 分页 --\x3e\r\n      <div :class="list && list.length<=7?\'page-nav\':\'page_center\'"\r\n           v-show="list && list.length>0">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n        \x3c!--分页的组件--\x3e\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\nimport { getPro, GET_City } from \'@/utils\'   //获取省市\r\nexport default {\r\n  data () {\r\n    return {\r\n      list: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      //分页数据\r\n      page: 1, //显示的页码数\r\n      pageCount: 1,\r\n      curId: 0,\r\n      thCurId: 0,\r\n      seCurId: 0,\r\n      threeAuthList: [],\r\n      authList: [],\r\n      detailsVisible: false, //详情弹框状态\r\n      currentReviewData: {},\r\n      detailsPage: 1,    //详情当前页数\r\n      detailsCount: 1,  //详情总页数\r\n      detailsList: [],  //详情列表\r\n      phone: \'\', // 负责人联系电话\r\n      company: \'\',  //搜索名称\r\n      year: \'\',\r\n      month: \'\',\r\n      provinceList: [],\r\n      cityList: [],\r\n      provinceId: "",\r\n      cityId: \'\'\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    company (val) {\r\n      this.init()\r\n    }\r\n  },\r\n  computed: {\r\n    dateTime () {\r\n\r\n      const dateTime = new Date(this.month)\r\n      const year = dateTime.getFullYear()\r\n      const month = dateTime.getMonth() + 1\r\n      return this.month ? `${year}-${month}` : \'\'\r\n    }\r\n  },\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    init () {\r\n\r\n      this.$axios.post(\'admin/UserAudit/cityOperateList\', { token: this.token, page: this.page, city: this.cityId, month: this.dateTime })\r\n        .then(res => {\r\n          this.list = res.data.data.list;\r\n          this.pageCount = res.data.data.rows;\r\n        }).catch(err => { })\r\n    },\r\n    //详情\r\n    async details (item) {\r\n      try {\r\n        this.currentReviewData = item\r\n        this.detailsVisible = true\r\n        const res = await this.$axios.post(\'admin/UserAudit/cityOperateDetail\', { token: this.token, id: item.id, page: this.detailsPage, month: this.dateTime, city: item.city_id })\r\n        this.detailsList = res.data.data.list || []\r\n        this.detailsCount = res.data.data.rows || 1\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    //搜索\r\n    search (time) {\r\n      this.page = 1;\r\n      console.log(time)\r\n      this.init()\r\n    },\r\n\r\n    Export () {  //导出\r\n      window.location.href = `${this.baseURL}admin/Login/channelList?city=${this.cityId}&month=${this.dateTime}`\r\n    },\r\n\r\n\r\n    // 获取省\r\n    async getProList () {\r\n      try {\r\n        const data = await getPro()\r\n        this.provinceList = data || []\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    //获取市\r\n    async getCity () {\r\n      try {\r\n        const data = await GET_City(this.provinceId)\r\n        this.cityList = data || []\r\n        this.cityId = this.provinceId && data[0].id\r\n        this.init()\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    Auth () {  //权限列表\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: window.sessionStorage.getItem(\'bbytoken\'),\r\n        id: id\r\n      })\r\n        .then(res => {\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].son) {\r\n                if (arr[i].name == \'渠道发卡\') {\r\n                  this.seCurId = arr[i].id;\r\n                  this.threeAuthList = arr[i].son;\r\n                }\r\n\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.Auth()\r\n    this.init()\r\n    this.getProList()\r\n  },\r\n}\r\n<\/script>\r\n<style scoped>\r\n.ellipsis {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n.areaDetails {\r\n  max-height: 300px;\r\n  min-height: 100px;\r\n  overflow: auto;\r\n}\r\n.areaDetails .area {\r\n  padding: 10px 0;\r\n  border-bottom: 1px solid #cccccc;\r\n}\r\n.areaDetails .province {\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},eoeZ:function(e,n,t){var r=t("ajxx");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("1b7dbbc1",r,!1,{})},zuJX:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("Xxa5"),i=t.n(r),a=t("exGp"),l=t.n(a),o=t("0xDb"),s={data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,curId:0,thCurId:0,seCurId:0,threeAuthList:[],authList:[],detailsVisible:!1,currentReviewData:{},detailsPage:1,detailsCount:1,detailsList:[],phone:"",company:"",year:"",month:"",provinceList:[],cityList:[],provinceId:"",cityId:""}},watch:{company:function(e){this.init()}},computed:{dateTime:function(){var e=new Date(this.month),n=e.getFullYear(),t=e.getMonth()+1;return this.month?n+"-"+t:""}},methods:{paging:function(e){this.page=e,this.init()},init:function(){var e=this;this.$axios.post("admin/UserAudit/cityOperateList",{token:this.token,page:this.page,city:this.cityId,month:this.dateTime}).then(function(n){e.list=n.data.data.list,e.pageCount=n.data.data.rows}).catch(function(e){})},details:function(e){var n=this;return l()(i.a.mark(function t(){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.currentReviewData=e,n.detailsVisible=!0,t.next=5,n.$axios.post("admin/UserAudit/cityOperateDetail",{token:n.token,id:e.id,page:n.detailsPage,month:n.dateTime,city:e.city_id});case 5:r=t.sent,n.detailsList=r.data.data.list||[],n.detailsCount=r.data.data.rows||1,t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(0),t.t0;case 13:case"end":return t.stop()}},t,n,[[0,10]])}))()},search:function(e){this.page=1,console.log(e),this.init()},Export:function(){window.location.href=this.baseURL+"admin/Login/channelList?city="+this.cityId+"&month="+this.dateTime},getProList:function(){var e=this;return l()(i.a.mark(function n(){var t;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(o.c)();case 3:t=n.sent,e.provinceList=t||[],n.next=10;break;case 7:throw n.prev=7,n.t0=n.catch(0),n.t0;case 10:case"end":return n.stop()}},n,e,[[0,7]])}))()},getCity:function(){var e=this;return l()(i.a.mark(function n(){var t;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(o.b)(e.provinceId);case 3:t=n.sent,e.cityList=t||[],e.cityId=e.provinceId&&t[0].id,e.init(),n.next=12;break;case 9:throw n.prev=9,n.t0=n.catch(0),n.t0;case 12:case"end":return n.stop()}},n,e,[[0,9]])}))()},Auth:function(){var e=this,n=this.$route.query.id;this.curId=n,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:n}).then(function(n){if(1==n.data.code){for(var t=n.data.data,r=0;r<t.length;r++)t[r].son&&"渠道发卡"==t[r].name&&(e.seCurId=t[r].id,e.threeAuthList=t[r].son);e.authList=t}else e.$alert(n.data.msg,"提示",{type:"error"})}).catch(function(e){alert(e)})}},mounted:function(){this.Auth(),this.init(),this.getProList()}},c=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("ctbHead",e._l(e.authList,function(n){return t("router-link",{key:n.id,class:e.seCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:e.curId}},"v-key":n.id}},[e._v("\n      "+e._s(n.name)+"\n    ")])}),1),e._v(" "),t("div",{staticClass:"container"},[t("div",{staticClass:"quote"},[t("div",{staticClass:"quote-ele"},[t("i"),e._v("\n        渠道发卡-发卡列表\n        "),t("el-button",{staticStyle:{float:"right",margin:"20px 40px 0 0"},attrs:{type:"primary"},on:{click:function(n){return e.Export()}}},[e._v("导出")])],1),e._v(" "),t("div",{staticClass:"quote-nav"},e._l(e.threeAuthList,function(n){return t("router-link",{key:n.id,class:e.thCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:e.curId}}}},[e._v("\n          "+e._s(n.name)+"\n        ")])}),1)]),e._v(" "),t("div",[t("el-col",{staticStyle:{"margin-right":"10px"},attrs:{span:5,offset:1}},[t("el-select",{attrs:{placeholder:"请选择省",clearable:""},on:{change:e.getCity},model:{value:e.provinceId,callback:function(n){e.provinceId=n},expression:"provinceId"}},e._l(e.provinceList,function(e,n){return t("el-option",{key:n,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),t("el-select",{attrs:{placeholder:"请选择市"},on:{change:function(n){return e.init()}},model:{value:e.cityId,callback:function(n){e.cityId=n},expression:"cityId"}},e._l(e.cityList,function(e,n){return t("el-option",{key:n,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{type:"month",placeholder:"选择月份","value-format":"yyyy-MM-dd"},on:{change:e.search},model:{value:e.month,callback:function(n){e.month=n},expression:"month"}})],1)],1),e._v(" "),t("el-table",{attrs:{data:e.list}},[t("el-table-column",{attrs:{prop:"company",label:"运营中心名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.province_name?t("div",[e._v("\n            "+e._s(""+n.row.province_name+n.row.city_name+"运营中心")+"\n          ")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"shop_count",label:"维修厂数量",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"card_num",label:"卡总数",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"consume_num",label:"消耗数量",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"supp",label:"补卡数量",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"sur_num",label:"剩余数量",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.details(n.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),t("el-dialog",{attrs:{title:"复核详情",visible:e.detailsVisible,center:"",width:"70%"},on:{"update:visible":function(n){e.detailsVisible=n},close:function(){e.detailsPage=1}}},[t("el-table",{attrs:{data:e.detailsList}},[t("el-table-column",{attrs:{align:"center",label:"维修厂名称",prop:"company"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"消耗数量",prop:"policy_count"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"新增"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(n.row.new?e.dateTime+"月份"+n.row.new:"")+"\n          ")]}}])})],1),e._v(" "),t("div",{staticClass:"page_center"},[t("paging",{attrs:{"page-count":e.detailsCount,page:e.detailsPage},on:{index:function(n){e.detailsPage=n,e.details(e.currentReviewData)}}})],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length>0,expression:"list && list.length>0"}],class:e.list&&e.list.length<=7?"page-nav":"page_center"},[t("paging",{attrs:{"page-count":e.pageCount,page:e.page},on:{index:e.paging}})],1)],1)],1)};c._withStripped=!0;var p={render:c,staticRenderFns:[]},d=p;var u=!1;var m=t("VU/8")(s,d,!1,function(e){u||t("eoeZ")},"data-v-5d664aee",null);m.options.__file="src/pages/channelIssuing/list/index.vue";n.default=m.exports}});
//# sourceMappingURL=113.50a1189cfb00f38ef3dc.js.map
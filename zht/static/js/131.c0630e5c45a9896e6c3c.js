webpackJsonp([131],{CgHY:function(e,n,t){var r=t("S8Ko");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("228a5bc4",r,!1,{})},S8Ko:function(e,n,t){(e.exports=t("FZ+f")(!0)).push([e.i,"\n.ellipsis[data-v-4a3e9cd7] {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/TexasTravel/enrollAudit/src/pages/TexasTravel/enrollAudit/unaudited.vue"],names:[],mappings:";AAuOA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA",file:"unaudited.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele"><i></i>德州旅行-注册审核-未审核</div>\r\n        <div class="quote-nav">\r\n          <router-link :class="thCurId==item.id? \'cur\':\'\'"\r\n                       v-for="item in threeAuthList"\r\n                       :key="item.id"\r\n                       :to="{path:item.action,query:{id:curId}}">\r\n            {{item.name}}\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n\r\n      <el-table :data="list">\r\n        \x3c!-- <el-table-column type="selection"\r\n                         width="55">\r\n        </el-table-column> --\x3e\r\n        <el-table-column label="单位名称"\r\n                         align="center"\r\n                         prop="tour_name">\r\n\r\n        </el-table-column>\r\n        <el-table-column label="负责人"\r\n                         align="center"\r\n                         prop="leader">\r\n\r\n        </el-table-column>\r\n        <el-table-column label="负责人电话"\r\n                         align="center"\r\n                         prop="phone">\r\n        </el-table-column>\r\n        <el-table-column label="注册类型"\r\n                         align="center"\r\n                         prop="type">\r\n        </el-table-column>\r\n        <el-table-column label="注册地区"\r\n                         align="center"\r\n                         prop="area">\r\n\r\n        </el-table-column>\r\n\r\n        <el-table-column label="详细地址"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-popover placement="top-start"\r\n                        width="200"\r\n                        trigger="hover"\r\n                        :content="`${scope.row.province}${scope.row.city}${scope.row.county}${scope.row.address}`">\r\n              <el-button slot="reference"\r\n                         type="text"\r\n                         class="ellipsis">{{`${scope.row.province}${scope.row.city}${scope.row.county}${scope.row.address}`}}</el-button>\r\n            </el-popover>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label="申请时间"\r\n                         align="center"\r\n                         prop="create_time">\r\n\r\n        </el-table-column>\r\n\r\n        <el-table-column label="操作"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-button type="primary"\r\n                       size="mini"\r\n                       :loading="throughLoading[scope.$index]"\r\n                       @click="through(scope.row)">通过</el-button>\r\n            <el-button type="danger"\r\n                       size="mini"\r\n                       :loading="rejecteLoading[scope.$index]"\r\n                       @click="rejecte(scope.row)">驳回</el-button>\r\n          </template>\r\n\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      \x3c!-- 分页 --\x3e\r\n      <div class="page_center"\r\n           v-show="list && list.length>0">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n        \x3c!--分页的组件--\x3e\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\nimport Viewer from \'@/utils/Viewer\'\r\nimport { getPro } from \'@/utils\'\r\nimport region from \'@/components/common\'\r\nexport default {\r\n  data () {\r\n    return {\r\n      list: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      page: 1,\r\n      pageCount: 1,\r\n      thCurId: \'\',\r\n      authList: [],\r\n      threeAuthList: [],\r\n      throughLoading: [],\r\n      rejecteLoading: [],\r\n\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n\r\n    init () {\r\n      this.$axios.post(\'admin/DeTravelExamine/regAudit\', { token: this.token, page: this.page, audit_status: 0 })\r\n        .then(res => {\r\n          this.list = res.data.data.list;\r\n          this.pageCount = res.data.data.rows;\r\n        }).catch(err => { })\r\n    },\r\n\r\n\r\n    //通过\r\n    through (item, index) {\r\n\r\n      this.$confirm(\'此操作将通过审核, 是否继续?\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        type: \'warning\',\r\n        center: true\r\n      }).then(async () => {\r\n        try {\r\n\r\n          this.throughLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/DeTravelExamine/regThrough\', { token: this.token, id: item.id, phone: item.phone, tour_name: item.tour_name })\r\n          this.throughLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: "success" })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (err) {\r\n          this.throughLoading[index] = false\r\n          throw (err)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n    //驳回\r\n    rejecte (item, index) {\r\n\r\n      this.$prompt(\'请输入驳回理由\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        inputPattern: /\\S/,\r\n        inputErrorMessage: \'请输入驳回理由\'\r\n      }).then(async ({ value }) => {\r\n        try {\r\n\r\n          this.rejecteLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/DeTravelExamine/regDismissal\', { token: this.token, id: item.id, reason: value, phone: item.phone, tour_name: item.tour_name })\r\n          this.rejecteLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: "success" })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (err) {\r\n          this.rejecteLoading[index] = false\r\n          throw (err)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n\r\n    Auth () {\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: window.sessionStorage.getItem(\'bbytoken\'),\r\n        id: id\r\n      })\r\n        .then(res => {\r\n\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].son) {\r\n                if (arr[i].name == \'注册审核\') {\r\n                  this.seCurId = arr[i].id;\r\n                  this.threeAuthList = arr[i].son;\r\n                }\r\n                for (var j = 0; j < arr[i].son.length; j++) {\r\n                  if (arr[i].action != arr[i].son[j].action) {\r\n                    arr[i].action = arr[i].son[0].action;\r\n                  }\r\n                  if (arr[i].son[j].name == \'未审核\' && arr[i].name == \'注册审核\') {\r\n                    this.thCurId = arr[i].son[j].id;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.Auth()\r\n    this.init()\r\n  },\r\n}\r\n<\/script>\r\n<style scoped>\r\n.ellipsis {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},"T/Pn":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("Xxa5"),a=t.n(r),i=t("exGp"),o=t.n(i),s=(t("gPgF"),t("0xDb"),t("E7z3"),{data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,thCurId:"",authList:[],threeAuthList:[],throughLoading:[],rejecteLoading:[]}},methods:{paging:function(e){this.page=e,this.init()},init:function(){var e=this;this.$axios.post("admin/DeTravelExamine/regAudit",{token:this.token,page:this.page,audit_status:0}).then(function(n){e.list=n.data.data.list,e.pageCount=n.data.data.rows}).catch(function(e){})},through:function(e,n){var t=this;this.$confirm("此操作将通过审核, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(o()(a.a.mark(function r(){var i;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.throughLoading[n]=!0,r.next=4,t.$axios.post("admin/DeTravelExamine/regThrough",{token:t.token,id:e.id,phone:e.phone,tour_name:e.tour_name});case 4:i=r.sent,t.throughLoading[n]=!1,1==i.data.code?(t.$message({message:i.data.msg,type:"success"}),t.init()):t.$message.error(i.data.msg),r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(0),t.throughLoading[n]=!1,r.t0;case 13:case"end":return r.stop()}},r,t,[[0,9]])}))).catch(function(){})},rejecte:function(e,n){var t,r=this;this.$prompt("请输入驳回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"请输入驳回理由"}).then((t=o()(a.a.mark(function t(i){var o,s=i.value;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.rejecteLoading[n]=!0,t.next=4,r.$axios.post("admin/DeTravelExamine/regDismissal",{token:r.token,id:e.id,reason:s,phone:e.phone,tour_name:e.tour_name});case 4:o=t.sent,r.rejecteLoading[n]=!1,1==o.data.code?(r.$message({message:o.data.msg,type:"success"}),r.init()):r.$message.error(o.data.msg),t.next=13;break;case 9:throw t.prev=9,t.t0=t.catch(0),r.rejecteLoading[n]=!1,t.t0;case 13:case"end":return t.stop()}},t,r,[[0,9]])})),function(e){return t.apply(this,arguments)})).catch(function(){})},Auth:function(){var e=this,n=this.$route.query.id;this.curId=n,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:n}).then(function(n){if(1==n.data.code){for(var t=n.data.data,r=0;r<t.length;r++)if(t[r].son){"注册审核"==t[r].name&&(e.seCurId=t[r].id,e.threeAuthList=t[r].son);for(var a=0;a<t[r].son.length;a++)t[r].action!=t[r].son[a].action&&(t[r].action=t[r].son[0].action),"未审核"==t[r].son[a].name&&"注册审核"==t[r].name&&(e.thCurId=t[r].son[a].id)}e.authList=t}else e.$alert(n.data.msg,"提示",{type:"error"})}).catch(function(e){alert(e)})}},mounted:function(){this.Auth(),this.init()}}),l=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("ctbHead",e._l(e.authList,function(n){return t("router-link",{key:n.id,class:e.seCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:e.curId}},"v-key":n.id}},[e._v("\n      "+e._s(n.name)+"\n    ")])}),1),e._v(" "),t("div",{staticClass:"container"},[t("div",{staticClass:"quote"},[e._m(0),e._v(" "),t("div",{staticClass:"quote-nav"},e._l(e.threeAuthList,function(n){return t("router-link",{key:n.id,class:e.thCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:e.curId}}}},[e._v("\n          "+e._s(n.name)+"\n        ")])}),1)]),e._v(" "),t("el-table",{attrs:{data:e.list}},[t("el-table-column",{attrs:{label:"单位名称",align:"center",prop:"tour_name"}}),e._v(" "),t("el-table-column",{attrs:{label:"负责人",align:"center",prop:"leader"}}),e._v(" "),t("el-table-column",{attrs:{label:"负责人电话",align:"center",prop:"phone"}}),e._v(" "),t("el-table-column",{attrs:{label:"注册类型",align:"center",prop:"type"}}),e._v(" "),t("el-table-column",{attrs:{label:"注册地区",align:"center",prop:"area"}}),e._v(" "),t("el-table-column",{attrs:{label:"详细地址",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:""+n.row.province+n.row.city+n.row.county+n.row.address}},[t("el-button",{staticClass:"ellipsis",attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(""+n.row.province+n.row.city+n.row.county+n.row.address))])],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"申请时间",align:"center",prop:"create_time"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"primary",size:"mini",loading:e.throughLoading[n.$index]},on:{click:function(t){return e.through(n.row)}}},[e._v("通过")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"mini",loading:e.rejecteLoading[n.$index]},on:{click:function(t){return e.rejecte(n.row)}}},[e._v("驳回")])]}}])})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length>0,expression:"list && list.length>0"}],staticClass:"page_center"},[t("paging",{attrs:{"page-count":e.pageCount,page:e.page},on:{index:e.paging}})],1)],1)],1)};l._withStripped=!0;var c={render:l,staticRenderFns:[function(){var e=this.$createElement,n=this._self._c||e;return n("div",{staticClass:"quote-ele"},[n("i"),this._v("德州旅行-注册审核-未审核")])}]},u=c;var d=!1;var p=t("VU/8")(s,u,!1,function(e){d||t("CgHY")},"data-v-4a3e9cd7",null);p.options.__file="src/pages/TexasTravel/enrollAudit/unaudited.vue";n.default=p.exports}});
//# sourceMappingURL=131.c0630e5c45a9896e6c3c.js.map
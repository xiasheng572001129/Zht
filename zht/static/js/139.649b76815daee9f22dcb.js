webpackJsonp([139],{F28Y:function(e,r,t){var n=t("nQp+");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t("rjj0")("771cf85d",n,!1,{})},"nQp+":function(e,r,t){(e.exports=t("FZ+f")(!0)).push([e.i,"\n.ellipsis[data-v-3fe074da] {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\n}\n.car_img[data-v-3fe074da] {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\n}\n.details > div[data-v-3fe074da] {\r\n  margin: 10px 0;\n}\n.details span[data-v-3fe074da]:first-child {\r\n  width: 100px;\r\n  text-align: right;\r\n  display: inline-block;\n}\n.img[data-v-3fe074da] {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/smallProgram/severCode/src/pages/smallProgram/severCode/index.vue"],names:[],mappings:";AAsMA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA;AACA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,eAAA;CACA;AACA;EACA,eAAA;CACA;AACA;EACA,aAAA;EACA,kBAAA;EACA,sBAAA;CACA;AACA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,eAAA;CACA",file:"index.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele"><i></i>小程序-服务工号列表</div>\r\n\r\n      </div>\r\n      <el-table :data="list">\r\n        <el-table-column align="center"\r\n                         label="用户名称"\r\n                         prop="name"></el-table-column>\r\n        <el-table-column align="center"\r\n                         label="联系电话"\r\n                         prop="phone"></el-table-column>\r\n\r\n        <el-table-column align="center"\r\n                         label="服务工号"\r\n                         prop="number">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="服务工号类型"\r\n                         prop="user_status">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="地区"\r\n                         prop="number">\r\n          <template slot-scope="scope">\r\n            <el-popover placement="top-start"\r\n                        width="200"\r\n                        trigger="hover"\r\n                        :content="`${scope.row.province}${scope.row.city}${scope.row.county}`">\r\n              <el-button slot="reference"\r\n                         type="text"\r\n                         class="ellipsis">{{`${scope.row.province}${scope.row.city}${scope.row.county}`}}</el-button>\r\n            </el-popover>\r\n          </template>\r\n        </el-table-column>\r\n\r\n        <el-table-column align="center"\r\n                         label="创建时间"\r\n                         prop="create_time">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="操作">\r\n          <template slot-scope="scope">\r\n            <el-switch v-model="scope.row.job_status"\r\n                       active-color="#13ce66"\r\n                       :active-value=\'1\'\r\n                       :inactive-value=\'2\'\r\n                       inactive-color="#ff4949"\r\n                       @change="(value)=>changeOpen(value,scope.row)">\r\n            </el-switch>\r\n            <el-button type="primary"\r\n                       size="small"\r\n                       style="margin-left:10px"\r\n                       @click="serviceForever(scope.row,scope.$index)"\r\n                       :loading=\'Loading[scope.$index]\'\r\n                       :disabled=\'scope.row.forever_status==1\'>长期有效</el-button>\r\n          </template>\r\n        </el-table-column>\r\n\r\n      </el-table>\r\n\r\n      <div class="page_center"\r\n           v-show="pageCount&&pageCount>1">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\n//  import page from \'../common.js\';\r\nimport Viewer from \'@/utils/Viewer\'\r\nexport default {\r\n  data () {\r\n    return {\r\n      authList: [],\r\n      threeAuthList: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      seCurId: 0,\r\n      page: 0,\r\n      pageCount: 0,\r\n      list: [],\r\n      detailsVisible: false,\r\n      detailsList: {},\r\n      Loading: [],\r\n      open: [], //开关\r\n    }\r\n  },\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    async init () {\r\n      try {\r\n        const res = await this.$axios.post(\'admin/UserServiceCode/index\', { token: this.token, page: this.page })\r\n        this.list = res.data.data.list || []\r\n        this.pageCount = res.data.data.rows || 0;\r\n      } catch (err) {\r\n        throw (err)\r\n      }\r\n    },\r\n    changeOpen (val, item) { //开关\r\n      let reasonText = val == 1 ? \'开启理由\' : \'关闭理由\'\r\n      this.$prompt(`请输入${reasonText}`, \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        inputPattern: /\\S/,\r\n        inputErrorMessage: `${reasonText}不能为空`\r\n      }).then(async ({ value }) => {\r\n        try {\r\n          const res = await this.$axios.post(\'admin/UserServiceCode/serviceAudit\', { token: this.token, uid: item.uid, id: item.id, job_status: val, reason: value })\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: \'success\' })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (error) {\r\n          throw (error)\r\n        }\r\n      }).catch(() => {\r\n        item.job_status = item.job_status == 1 ? 2 : 1\r\n      });\r\n    },\r\n    serviceForever (item, index) {   //服务工号长期有效\r\n      this.$confirm(\'此操将开启长期有效, 是否继续?\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        type: \'warning\'\r\n      }).then(async () => {\r\n        try {\r\n          this.Loading[index] = true\r\n          const res = await this.$axios.post(\'admin/UserServiceCode/serviceForever\', { token: this.token, uid: item.uid, id: item.id, forever_status: 1 })\r\n          this.Loading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: "success" })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (error) {\r\n          this.Loading[index] = false\r\n          throw (error)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n    erAuth () {\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: this.token,\r\n        id: id\r\n      })\r\n        .then(res => {\r\n\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].name == \'服务工号\') {\r\n                this.seCurId = arr[i].id;\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n\r\n  mounted () {\r\n    this.init()\r\n    this.erAuth()\r\n  },\r\n\r\n}\r\n<\/script>\r\n<style scoped>\r\n.ellipsis {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n.car_img {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\r\n}\r\n.details > div {\r\n  margin: 10px 0;\r\n}\r\n.details span:first-child {\r\n  width: 100px;\r\n  text-align: right;\r\n  display: inline-block;\r\n}\r\n.img {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},q6tg:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("Xxa5"),a=t.n(n),i=t("exGp"),s=t.n(i),o=(t("gPgF"),{data:function(){return{authList:[],threeAuthList:[],token:window.sessionStorage.getItem("bbytoken"),seCurId:0,page:0,pageCount:0,list:[],detailsVisible:!1,detailsList:{},Loading:[],open:[]}},methods:{paging:function(e){this.page=e,this.init()},init:function(){var e=this;return s()(a.a.mark(function r(){var t;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.post("admin/UserServiceCode/index",{token:e.token,page:e.page});case 3:t=r.sent,e.list=t.data.data.list||[],e.pageCount=t.data.data.rows||0,r.next=11;break;case 8:throw r.prev=8,r.t0=r.catch(0),r.t0;case 11:case"end":return r.stop()}},r,e,[[0,8]])}))()},changeOpen:function(e,r){var t,n=this,i=1==e?"开启理由":"关闭理由";this.$prompt("请输入"+i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:i+"不能为空"}).then((t=s()(a.a.mark(function t(i){var s,o=i.value;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.$axios.post("admin/UserServiceCode/serviceAudit",{token:n.token,uid:r.uid,id:r.id,job_status:e,reason:o});case 3:1==(s=t.sent).data.code?(n.$message({message:s.data.msg,type:"success"}),n.init()):n.$message.error(s.data.msg),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,n,[[0,7]])})),function(e){return t.apply(this,arguments)})).catch(function(){r.job_status=1==r.job_status?2:1})},serviceForever:function(e,r){var t=this;this.$confirm("此操将开启长期有效, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(s()(a.a.mark(function n(){var i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.Loading[r]=!0,n.next=4,t.$axios.post("admin/UserServiceCode/serviceForever",{token:t.token,uid:e.uid,id:e.id,forever_status:1});case 4:i=n.sent,t.Loading[r]=!1,1==i.data.code?(t.$message({message:i.data.msg,type:"success"}),t.init()):t.$message.error(i.data.msg),n.next=13;break;case 9:throw n.prev=9,n.t0=n.catch(0),t.Loading[r]=!1,n.t0;case 13:case"end":return n.stop()}},n,t,[[0,9]])}))).catch(function(){})},erAuth:function(){var e=this,r=this.$route.query.id;this.curId=r,this.$axios.post("admin/Auth/erAuth",{token:this.token,id:r}).then(function(r){if(1==r.data.code){for(var t=r.data.data,n=0;n<t.length;n++)"服务工号"==t[n].name&&(e.seCurId=t[n].id);e.authList=t}else e.$alert(r.data.msg,"提示",{type:"error"})}).catch(function(e){alert(e)})}},mounted:function(){this.init(),this.erAuth()}}),l=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("ctbHead",e._l(e.authList,function(r){return t("router-link",{key:r.id,class:e.seCurId==r.id?"cur":"",attrs:{to:{path:r.action,query:{id:e.curId}},"v-key":r.id}},[e._v("\n      "+e._s(r.name)+"\n    ")])}),1),e._v(" "),t("div",{staticClass:"container"},[e._m(0),e._v(" "),t("el-table",{attrs:{data:e.list}},[t("el-table-column",{attrs:{align:"center",label:"用户名称",prop:"name"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"联系电话",prop:"phone"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"服务工号",prop:"number"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"服务工号类型",prop:"user_status"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"地区",prop:"number"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:""+r.row.province+r.row.city+r.row.county}},[t("el-button",{staticClass:"ellipsis",attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(""+r.row.province+r.row.city+r.row.county))])],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"create_time"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":2,"inactive-color":"#ff4949"},on:{change:function(t){return e.changeOpen(t,r.row)}},model:{value:r.row.job_status,callback:function(t){e.$set(r.row,"job_status",t)},expression:"scope.row.job_status"}}),e._v(" "),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small",loading:e.Loading[r.$index],disabled:1==r.row.forever_status},on:{click:function(t){return e.serviceForever(r.row,r.$index)}}},[e._v("长期有效")])]}}])})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.pageCount&&e.pageCount>1,expression:"pageCount&&pageCount>1"}],staticClass:"page_center"},[t("paging",{attrs:{"page-count":e.pageCount,page:e.page},on:{index:e.paging}})],1)],1)],1)};l._withStripped=!0;var c={render:l,staticRenderFns:[function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"quote"},[r("div",{staticClass:"quote-ele"},[r("i"),this._v("小程序-服务工号列表")])])}]},d=c;var u=!1;var p=t("VU/8")(o,d,!1,function(e){u||t("F28Y")},"data-v-3fe074da",null);p.options.__file="src/pages/smallProgram/severCode/index.vue";r.default=p.exports}});
//# sourceMappingURL=139.649b76815daee9f22dcb.js.map
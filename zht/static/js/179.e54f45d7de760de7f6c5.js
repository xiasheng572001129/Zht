webpackJsonp([179],{WUkP:function(e,t,n){var r=n("bjHp");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n("rjj0")("5f7705fc",r,!1,{})},bjHp:function(e,t,n){(e.exports=n("FZ+f")(!0)).push([e.i,'\n.ellipsis[data-v-0872ace8] {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\n}\n.search[data-v-0872ace8] {\r\n  width: 15%;\r\n  margin-right: 10px;\n}\n.region[data-v-0872ace8] {\r\n  width: 10%;\r\n  margin: 0 10px;\n}\n.img[data-v-0872ace8] {\r\n  width: 70px;\r\n  height: 70px;\n}\n.images[data-v-0872ace8] {\r\n  width: 100px;\r\n  height: 100px;\r\n  margin-right: 10px;\r\n  vertical-align: top;\n}\n.laybox2 ul[data-v-0872ace8] {\r\n  margin: 33px auto;\r\n  border-bottom: 1px dashed #04bbfc;\n}\n.laybox2[data-v-0872ace8] {\r\n  padding: 60px;\r\n  font-size: 16px;\n}\n.laybox2 li[data-v-0872ace8] {\r\n  width: 300px;\r\n  text-align: left;\r\n  margin: 33px auto;\n}\n.t-c[data-v-0872ace8]:after {\r\n  content: "";\r\n  display: block;\r\n  height: 0;\r\n  clear: both;\n}\n.bot > div[data-v-0872ace8] {\r\n  position: relative;\n}\ndiv.bot[data-v-0872ace8] {\r\n  margin: 45px auto 35px auto;\r\n  height: 100px;\n}\ndiv.bot span[data-v-0872ace8] {\r\n  display: inline-block;\r\n  width: 20%;\n}\ndiv.bot input[data-v-0872ace8] {\r\n  display: inline-block;\r\n  width: 55%;\r\n  outline: none;\r\n  border: none;\r\n  border-bottom: 1px solid #aaa;\n}\ndiv.bot button[data-v-0872ace8] {\r\n  width: 110px;\r\n  height: 36px;\r\n  margin-left: -55px;\r\n  position: absolute;\r\n  border-radius: 18px;\r\n  -webkit-box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\r\n          box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\r\n  border: none;\r\n  color: #fff;\r\n  left: 50%;\r\n  top: 60px;\n}\nbutton.reject[data-v-0872ace8] {\r\n  background: rgba(237, 81, 55, 1);\r\n  margin-right: 30%;\n}\nbutton.pass[data-v-0872ace8] {\r\n  background-color: #20a0ff;\n}\n.left[data-v-0872ace8] {\r\n  float: left;\r\n  width: 50%;\n}\n.right[data-v-0872ace8] {\r\n  float: right;\r\n  width: 50%;\n}\n.nowrap[data-v-0872ace8] {\r\n  width: 120px !important;\r\n  text-align: center;\r\n  white-space: nowrap; /*规定文本不换行**/\r\n  text-overflow: ellipsis; /**显示省略符号来代表被修剪的文本。*/\r\n  overflow: hidden;\r\n  margin: 0 auto;\n}\n.regionDetail[data-v-0872ace8] .el-dialog__title {\r\n  font-size: 22px;\n}\n.regionDetail[data-v-0872ace8] .el-dialog__body {\r\n  padding: 0px 25px 30px;\r\n  border-top: solid 2px #eee;\n}\r\n',"",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/audit/channel/src/pages/audit/channel/twiceReview.vue"],names:[],mappings:";AA+hBA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA;AACA;EACA,WAAA;EACA,mBAAA;CACA;AACA;EACA,WAAA;EACA,eAAA;CACA;AACA;EACA,YAAA;EACA,aAAA;CACA;AACA;EACA,aAAA;EACA,cAAA;EACA,mBAAA;EACA,oBAAA;CACA;AACA;EACA,kBAAA;EACA,kCAAA;CACA;AAEA;EACA,cAAA;EACA,gBAAA;CACA;AAEA;EACA,aAAA;EACA,iBAAA;EACA,kBAAA;CACA;AAEA;EACA,YAAA;EACA,eAAA;EACA,UAAA;EACA,YAAA;CACA;AAEA;EACA,mBAAA;CACA;AAEA;EACA,4BAAA;EACA,cAAA;CACA;AAEA;EACA,sBAAA;EACA,WAAA;CACA;AAEA;EACA,sBAAA;EACA,WAAA;EACA,cAAA;EACA,aAAA;EACA,8BAAA;CACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,oBAAA;EACA,uDAAA;UAAA,+CAAA;EACA,aAAA;EACA,YAAA;EACA,UAAA;EACA,UAAA;CACA;AAEA;EACA,iCAAA;EACA,kBAAA;CACA;AAEA;EACA,0BAAA;CACA;AAEA;EACA,YAAA;EACA,WAAA;CACA;AACA;EACA,aAAA;EACA,WAAA;CACA;AACA;EACA,wBAAA;EACA,mBAAA;EACA,oBAAA,CAAA,YAAA;EACA,wBAAA,CAAA,qBAAA;EACA,iBAAA;EACA,eAAA;CACA;AACA;EACA,gBAAA;CACA;AACA;EACA,uBAAA;EACA,2BAAA;CACA",file:"twiceReview.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele"><i></i>审核-免费保养-二次复核</div>\r\n        <div class="quote-nav">\r\n          <router-link :class="thCurId==item.id? \'cur\':\'\'"\r\n                       v-for="item in threeAuthList"\r\n                       :key="item.id"\r\n                       :to="{path:item.action,query:{id:curId}}">\r\n            {{item.name}}\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n      <div style="margin:0 20px">\r\n        \x3c!-- <el-input placeholder="请输入维修厂"\r\n                  v-model="ListQuery.company"\r\n                  class="input-with-select search">\r\n          <el-button slot="append"\r\n                     icon="el-icon-search"\r\n                     @click="page=1,init()"></el-button>\r\n        </el-input> --\x3e\r\n        <el-select style="margin-right:10px"\r\n                   v-model="ListQuery.ucp_company"\r\n                   placeholder="请选择保险公司"\r\n                   @change="page=1,init()">\r\n          <el-option v-for="(item,index) in companyList"\r\n                     :key="index"\r\n                     :label="item.company"\r\n                     :value="item.id"></el-option>\r\n        </el-select>\r\n        <el-date-picker v-model="pickerSearch"\r\n                        type="daterange"\r\n                        style="width:24%;margin-right:10px"\r\n                        @change="page=1,init()"\r\n                        value-format="yyyy-MM-dd"\r\n                        range-separator="至"\r\n                        start-placeholder="开始日期"\r\n                        end-placeholder="结束日期">\r\n        </el-date-picker>\r\n        省:\r\n        <el-select v-model="ListQuery.search[\'province\']"\r\n                   placeholder="请选择省"\r\n                   class="region"\r\n                   @change="getCity">\r\n          <el-option v-for="item in provincelist"\r\n                     :key="item.id"\r\n                     :label="item.name"\r\n                     :value="item.id">\r\n          </el-option>\r\n        </el-select>\r\n        市:\r\n        <el-select v-model="ListQuery.search[\'city\']"\r\n                   placeholder="请选择市"\r\n                   class="region"\r\n                   @change="getCounty">\r\n          <el-option v-for="item in citylist"\r\n                     :key="item.id"\r\n                     :label="item.name"\r\n                     :value="item.id">\r\n          </el-option>\r\n        </el-select>\r\n        区/县:\r\n        <el-select v-model="ListQuery.county"\r\n                   placeholder="请选择区/县"\r\n                   @change="changeCounty"\r\n                   class="region">\r\n          <el-option v-for="item in countyList"\r\n                     :key="item.id"\r\n                     :label="item.name"\r\n                     :value="item.id">\r\n          </el-option>\r\n        </el-select>\r\n        \x3c!-- <el-button type="primary"\r\n                   class="printRight"\r\n                   @click="print">下载</el-button> --\x3e\r\n      </div>\r\n      <el-table :data="list"\r\n                tooltip-effect="dark">\r\n        \x3c!-- <el-table-column type="selection"\r\n                         width="55">\r\n        </el-table-column> --\x3e\r\n        \x3c!-- <el-table-column label="福利"\r\n                         align="center"\r\n                         prop="user_type">\r\n          <template slot-scope="scope">\r\n            <el-button type="text"\r\n                       v-if=\'scope.row.user_type==1\'\r\n                       @click="details(scope.row)">保险公司</el-button>\r\n            <span v-else>\r\n              {{scope.row.user_type==1 ? \'保险公司\' : scope.row.user_type==2 ? \'主机厂\' : \'其他类型\'}}\r\n            </span>\r\n          </template>\r\n        </el-table-column> --\x3e\r\n        <el-table-column prop="ucp_company"\r\n                         label="保险公司名称"\r\n                         align="center"></el-table-column>\r\n        <el-table-column prop="company"\r\n                         label="维修厂名称"\r\n                         align="center"></el-table-column>\r\n        \x3c!-- <el-table-column prop="phone"\r\n                         label="联系电话"\r\n                         align="center"></el-table-column>\r\n        <el-table-column prop="leader"\r\n                         label="负责人"\r\n                         align="center"></el-table-column> --\x3e\r\n        <el-table-column label="地区"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-popover placement="top-start"\r\n                        title="地区详情"\r\n                        width="200"\r\n                        trigger="hover"\r\n                        :content="`${scope.row.province}${scope.row.city}${scope.row.county}`">\r\n              <el-button type="text"\r\n                         slot="reference"\r\n                         class="ellipsis">{{`${scope.row.province}${scope.row.city}${scope.row.county}`}}</el-button>\r\n            </el-popover>\r\n          </template>\r\n\r\n        </el-table-column>\r\n        <el-table-column label="复核数量"\r\n                         align="center"\r\n                         prop="num">\r\n        </el-table-column>\r\n        <el-table-column label="操作"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-button type="primary"\r\n                       size="mini"\r\n                       @click="details(scope.row)">详情</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      \x3c!-- 分页 --\x3e\r\n      <div :class="list && list.length<=7?\'page-nav\':\'page_center\'"\r\n           v-show="list && list.length>0">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n        \x3c!--分页的组件--\x3e\r\n      </div>\r\n    </div>\r\n    <el-dialog title="详情"\r\n               center\r\n               :visible.sync="detailsVisible"\r\n               width="80%"\r\n               @close=\'detailsPage=1,detailsCount=1\'>\r\n      <el-table :data="detailsList"\r\n                class="detailsTable">\r\n        <el-table-column align="center"\r\n                         label="施工照片">\r\n          <template slot-scope="scope">\r\n            <div>\r\n              <img v-for="(item,index) in scope.row.oil_photo"\r\n                   :key="index"\r\n                   :src="item"\r\n                   width="50px"\r\n                   height="50px"\r\n                   ref="oil_photo" />\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        \x3c!-- <el-table-column align="center"\r\n                         prop="ucp_company"\r\n                         label="保险公司名称">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         prop="name"\r\n                         label="车辆名称">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         prop="type"\r\n                         label="车辆类型">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         prop="series"\r\n                         label="车排量">\r\n\r\n        </el-table-column> --\x3e\r\n        <el-table-column align="center"\r\n                         prop="plate"\r\n                         label="车牌号">\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         prop="rankers"\r\n                         label="类型">\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         label="老兵姓名">\r\n          <template slot-scope="scope">\r\n            {{scope.row.ranker==6 ? scope.row.old_name : \'无\'}}\r\n          </template>\r\n        </el-table-column>\r\n        \x3c!-- <el-table-column align="center"\r\n                         prop="vin"\r\n                         label="vin码">\r\n\r\n        </el-table-column>\r\n        <el-table-column align="center"\r\n                         prop="policy_num"\r\n                         label="保单号">\r\n          <template slot-scope="scope">\r\n            {{scope.row.policy_num || \'无\'}}\r\n          </template>\r\n        </el-table-column> --\x3e\r\n        <el-table-column align="center"\r\n                         prop=""\r\n                         label="保单图片/优待证">\r\n          <template slot-scope="scope">\r\n\r\n            <el-button type="text"\r\n                       v-if="scope.row.pc_img && scope.row.pc_img.length>0"\r\n                       @click="pcImgVisible=true,imgList=scope.row.pc_img,imgDetails()">详情</el-button>\r\n            <span v-else>无</span>\r\n\r\n          </template>\r\n        </el-table-column>\r\n        \x3c!-- <el-table-column align="center"\r\n                         prop="start_time"\r\n                         label="开始时间">\r\n          <template slot-scope="scope">\r\n            {{scope.row.start_time || \'无\'}}\r\n          </template>\r\n        </el-table-column> --\x3e\r\n        <el-table-column align="center"\r\n                         label="修改时间">\r\n          <template slot-scope="scope">\r\n            {{scope.row.audit_time | datetime}}\r\n          </template>\r\n        </el-table-column>\r\n\r\n        <el-table-column min-width="100px"\r\n                         label="操作"\r\n                         align="center">\r\n          <template slot-scope="scope">\r\n            <el-button type="primary"\r\n                       size=\'mini\'\r\n                       :loading="throughLoading[scope.$index]"\r\n                       @click="through(scope.row,scope.$index)">通过</el-button>\r\n            <el-button type="danger"\r\n                       size=\'mini\'\r\n                       :loading="rejecteLoading[scope.$index]"\r\n                       @click="rejecte(scope.row,scope.$index)">驳回</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class="page_center">\r\n        <paging :page-count="detailsCount"\r\n                :page="detailsPage"\r\n                @index="detailsPaging"></paging>\r\n        \x3c!--分页的组件--\x3e\r\n      </div>\r\n\r\n      <el-dialog center\r\n                 title="保单图片"\r\n                 :visible.sync="pcImgVisible"\r\n                 append-to-body\r\n                 width="25%">\r\n        <div>\r\n          <img v-for="(item,index) in imgList"\r\n               style="width:100px;height:100px;margin-right:20px"\r\n               :key=\'index\'\r\n               :src="item"\r\n               ref="img" />\r\n        </div>\r\n      </el-dialog>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\nimport Viewer from \'@/utils/Viewer\'\r\nimport { getPro } from \'@/utils\'\r\nimport region from \'@/components/common\'\r\nexport default {\r\n  data () {\r\n    return {\r\n      list: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      page: 1,\r\n      pageCount: 1,\r\n      thCurId: \'\',\r\n      authList: [],\r\n      threeAuthList: [],\r\n      throughLoading: [],\r\n      rejecteLoading: [],\r\n      detailsVisible: false,\r\n      pcImgVisible: false,\r\n      multipleData: [],\r\n      detailsList: [],\r\n      detailsPage: 1,\r\n      detailsCount: 1,\r\n      currentDetails: {},\r\n      ListQuery: {\r\n        company: \'\',\r\n        ucp_company: \'\',\r\n        start_time: \'\',\r\n        end_time: \'\',\r\n        city: \'\',\r\n        county: \'\',\r\n        search: []\r\n      },\r\n      pickerSearch: "",\r\n      provincelist: [],\r\n      citylist: [],\r\n      countyList: [],\r\n      companyList: [], //保险公司列表\r\n      imgList: []\r\n    }\r\n  },\r\n  created () {\r\n    this.init();\r\n  },\r\n  watch: {\r\n    pickerSearch (val) {   //获取日期\r\n      if (val) {\r\n        this.ListQuery.start_time = val[0]\r\n        this.ListQuery.end_time = val[1]\r\n      } else {\r\n        this.ListQuery.start_time = \'\'\r\n        this.ListQuery.end_time = \'\'\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    GetCity: region.getCity,\r\n    GetCounty: region.getCounty,\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    detailsPaging (e) {\r\n      this.detailsPage = e;\r\n      this.details(this.currentDetails)\r\n    },\r\n    init () {\r\n      this.$axios.post(\'admin/UserAudit/channelLists\', Object.assign(this.ListQuery, { token: this.token, page: this.page, status: 0, pay_status: 1, review: 2 }))\r\n        .then(res => {\r\n          this.list = res.data.data.list;\r\n          this.pageCount = res.data.data.rows;\r\n        }).catch(err => { })\r\n    },\r\n    //获取保险公司\r\n    async getCompany () {\r\n      try {\r\n        const res = await this.$axios.post(\'admin/UserAudit/policyCompany\', { token: this.token, type_channel: 1 })\r\n        this.companyList = res.data.data || []\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    //获取全部省\r\n    async getProvince () {\r\n      try {\r\n        const res = await getPro();\r\n        this.provincelist = res;\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    //获取市\r\n    getCity (id) {\r\n      this.page = 1\r\n      this.ListQuery.search[\'province\'] = this.query(this.provincelist, id)\r\n      this.ListQuery.search[\'city\'] = \'\'  //清空上一次所选的市\r\n      this.ListQuery.county = \'\'  //清空上一次所选的区/县\r\n      this.ListQuery.search[\'county_id\'] = \'\'  //清空上一次所选的区/县id\r\n      this.GetCity(id).then(res => {\r\n        this.citylist = res\r\n      })\r\n      this.init()\r\n    },\r\n    //获取 区/县\r\n    getCounty (id) {\r\n      this.page = 1\r\n      this.ListQuery.search[\'city\'] = this.query(this.citylist, id)\r\n      this.ListQuery.county = \'\' //清空上一次所选的区/县\r\n      this.ListQuery.search[\'county_id\'] = \'\' //清空上一次所选的区/县id\r\n      this.GetCounty(id).then(res => {\r\n        this.countyList = res\r\n      })\r\n      this.init()\r\n    },\r\n    changeCounty (id) {\r\n      this.page = 1\r\n      this.ListQuery.search[\'county_id\'] = id\r\n      this.init()\r\n    },\r\n    //通过 id 查询\r\n    query (array, id) {  //array 查询的数组  id 通过当前id查询array数组的数据\r\n      console.log(array)\r\n      let newArray = array.filter(item => {\r\n        return item.id == id\r\n      })\r\n      return newArray[0].name\r\n    },\r\n    async details (row) {  //详情\r\n      this.detailsVisible = true\r\n      this.currentDetails = row\r\n      try {\r\n        const res = await this.$axios.post("admin/UserAudit/details", { token: this.token, sid: row.id, policy_id: row.policy_id, status: row.status, page: this.detailsPage, start_time: this.ListQuery.start_time, end_time: this.ListQuery.end_time })\r\n        this.detailsList = res.data.data.list || [];\r\n        this.detailsCount = res.data.data.rows;\r\n        this.$nextTick(() => {  //施工图放大\r\n          if (this.$refs.oil_photo && this.$refs.oil_photo.length > 0) {\r\n            Viewer(this.$refs.oil_photo)\r\n          }\r\n        })\r\n\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n\r\n    },\r\n    // handleSelectionChange (val) {  //全选/单选\r\n    //   let tmp = []\r\n    //   val.forEach(el => {\r\n    //     tmp.push({ ucp_id: el.ucp_id, uc_id: el.uc_id, user_type: el.user_type })\r\n    //   });\r\n\r\n    //   this.multipleData = tmp\r\n    // },\r\n    imgDetails () {  //保单图片详情\r\n      this.$nextTick(() => {\r\n        console.log(this.$refs)\r\n        const img = this.$refs.img\r\n        Viewer(img)\r\n      })\r\n    },\r\n    //通过\r\n    through (item, index) {\r\n\r\n      this.$confirm(\'此操作将通过审核, 是否继续?\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        type: \'warning\',\r\n        center: true\r\n      }).then(async () => {\r\n        try {\r\n\r\n          this.throughLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/UserAudit/channelAdopt\', { token: this.token, ucp_id: item.ucp_id, card_id: item.card_id })\r\n          this.throughLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: "success" })\r\n            this.init()\r\n            this.details(this.currentDetails)\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (err) {\r\n          this.throughLoading[index] = false\r\n          throw (err)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n    //驳回\r\n    rejecte (item, index) {\r\n\r\n      this.$prompt(\'请输入驳回理由\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        inputPattern: /\\S/,\r\n        inputErrorMessage: \'请输入驳回理由\'\r\n      }).then(async ({ value }) => {\r\n        try {\r\n\r\n          this.rejecteLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/UserAudit/channelReject\', { token: this.token, ucp_id: item.ucp_id, uc_id: item.uc_id, reason: value })\r\n          this.rejecteLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: "success" })\r\n            this.details(this.currentDetails)\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (err) {\r\n          this.rejecteLoading[index] = false\r\n          throw (err)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n\r\n    Auth () {\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: window.sessionStorage.getItem(\'bbytoken\'),\r\n        id: id\r\n      })\r\n        .then(res => {\r\n\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].son) {\r\n                if (arr[i].name == \'免费保养\') {\r\n                  this.seCurId = arr[i].id;\r\n                  this.threeAuthList = arr[i].son;\r\n                }\r\n                for (var j = 0; j < arr[i].son.length; j++) {\r\n                  if (arr[i].action != arr[i].son[j].action) {\r\n                    arr[i].action = arr[i].son[0].action;\r\n                  }\r\n                  if (arr[i].son[j].name == \'二次复核\' && arr[i].name == \'免费保养\') {\r\n                    this.thCurId = arr[i].son[j].id;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.Auth()\r\n    this.getProvince()\r\n    this.getCompany()\r\n\r\n  },\r\n}\r\n<\/script>\r\n<style scoped>\r\n.ellipsis {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n.search {\r\n  width: 15%;\r\n  margin-right: 10px;\r\n}\r\n.region {\r\n  width: 10%;\r\n  margin: 0 10px;\r\n}\r\n.img {\r\n  width: 70px;\r\n  height: 70px;\r\n}\r\n.images {\r\n  width: 100px;\r\n  height: 100px;\r\n  margin-right: 10px;\r\n  vertical-align: top;\r\n}\r\n.laybox2 ul {\r\n  margin: 33px auto;\r\n  border-bottom: 1px dashed #04bbfc;\r\n}\r\n\r\n.laybox2 {\r\n  padding: 60px;\r\n  font-size: 16px;\r\n}\r\n\r\n.laybox2 li {\r\n  width: 300px;\r\n  text-align: left;\r\n  margin: 33px auto;\r\n}\r\n\r\n.t-c:after {\r\n  content: "";\r\n  display: block;\r\n  height: 0;\r\n  clear: both;\r\n}\r\n\r\n.bot > div {\r\n  position: relative;\r\n}\r\n\r\ndiv.bot {\r\n  margin: 45px auto 35px auto;\r\n  height: 100px;\r\n}\r\n\r\ndiv.bot span {\r\n  display: inline-block;\r\n  width: 20%;\r\n}\r\n\r\ndiv.bot input {\r\n  display: inline-block;\r\n  width: 55%;\r\n  outline: none;\r\n  border: none;\r\n  border-bottom: 1px solid #aaa;\r\n}\r\n\r\ndiv.bot button {\r\n  width: 110px;\r\n  height: 36px;\r\n  margin-left: -55px;\r\n  position: absolute;\r\n  border-radius: 18px;\r\n  box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\r\n  border: none;\r\n  color: #fff;\r\n  left: 50%;\r\n  top: 60px;\r\n}\r\n\r\nbutton.reject {\r\n  background: rgba(237, 81, 55, 1);\r\n  margin-right: 30%;\r\n}\r\n\r\nbutton.pass {\r\n  background-color: #20a0ff;\r\n}\r\n\r\n.left {\r\n  float: left;\r\n  width: 50%;\r\n}\r\n.right {\r\n  float: right;\r\n  width: 50%;\r\n}\r\n.nowrap {\r\n  width: 120px !important;\r\n  text-align: center;\r\n  white-space: nowrap; /*规定文本不换行**/\r\n  text-overflow: ellipsis; /**显示省略符号来代表被修剪的文本。*/\r\n  overflow: hidden;\r\n  margin: 0 auto;\r\n}\r\n.regionDetail >>> .el-dialog__title {\r\n  font-size: 22px;\r\n}\r\n.regionDetail >>> .el-dialog__body {\r\n  padding: 0px 25px 30px;\r\n  border-top: solid 2px #eee;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},"tid+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),i=n.n(r),a=n("exGp"),o=n.n(a),s=n("woOf"),l=n.n(s),c=n("gPgF"),p=n("0xDb"),u=n("E7z3"),d={data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,thCurId:"",authList:[],threeAuthList:[],throughLoading:[],rejecteLoading:[],detailsVisible:!1,pcImgVisible:!1,multipleData:[],detailsList:[],detailsPage:1,detailsCount:1,currentDetails:{},ListQuery:{company:"",ucp_company:"",start_time:"",end_time:"",city:"",county:"",search:[]},pickerSearch:"",provincelist:[],citylist:[],countyList:[],companyList:[],imgList:[]}},created:function(){this.init()},watch:{pickerSearch:function(e){e?(this.ListQuery.start_time=e[0],this.ListQuery.end_time=e[1]):(this.ListQuery.start_time="",this.ListQuery.end_time="")}},methods:{GetCity:u.a.getCity,GetCounty:u.a.getCounty,paging:function(e){this.page=e,this.init()},detailsPaging:function(e){this.detailsPage=e,this.details(this.currentDetails)},init:function(){var e=this;this.$axios.post("admin/UserAudit/channelLists",l()(this.ListQuery,{token:this.token,page:this.page,status:0,pay_status:1,review:2})).then(function(t){e.list=t.data.data.list,e.pageCount=t.data.data.rows}).catch(function(e){})},getCompany:function(){var e=this;return o()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("admin/UserAudit/policyCompany",{token:e.token,type_channel:1});case 3:n=t.sent,e.companyList=n.data.data||[],t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getProvince:function(){var e=this;return o()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(p.c)();case 3:n=t.sent,e.provincelist=n,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getCity:function(e){var t=this;this.page=1,this.ListQuery.search.province=this.query(this.provincelist,e),this.ListQuery.search.city="",this.ListQuery.county="",this.ListQuery.search.county_id="",this.GetCity(e).then(function(e){t.citylist=e}),this.init()},getCounty:function(e){var t=this;this.page=1,this.ListQuery.search.city=this.query(this.citylist,e),this.ListQuery.county="",this.ListQuery.search.county_id="",this.GetCounty(e).then(function(e){t.countyList=e}),this.init()},changeCounty:function(e){this.page=1,this.ListQuery.search.county_id=e,this.init()},query:function(e,t){return console.log(e),e.filter(function(e){return e.id==t})[0].name},details:function(e){var t=this;return o()(i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.detailsVisible=!0,t.currentDetails=e,n.prev=2,n.next=5,t.$axios.post("admin/UserAudit/details",{token:t.token,sid:e.id,policy_id:e.policy_id,status:e.status,page:t.detailsPage,start_time:t.ListQuery.start_time,end_time:t.ListQuery.end_time});case 5:r=n.sent,t.detailsList=r.data.data.list||[],t.detailsCount=r.data.data.rows,t.$nextTick(function(){t.$refs.oil_photo&&t.$refs.oil_photo.length>0&&Object(c.a)(t.$refs.oil_photo)}),n.next=14;break;case 11:throw n.prev=11,n.t0=n.catch(2),n.t0;case 14:case"end":return n.stop()}},n,t,[[2,11]])}))()},imgDetails:function(){var e=this;this.$nextTick(function(){console.log(e.$refs);var t=e.$refs.img;Object(c.a)(t)})},through:function(e,t){var n=this;this.$confirm("此操作将通过审核, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(o()(i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n.throughLoading[t]=!0,r.next=4,n.$axios.post("admin/UserAudit/channelAdopt",{token:n.token,ucp_id:e.ucp_id,card_id:e.card_id});case 4:a=r.sent,n.throughLoading[t]=!1,1==a.data.code?(n.$message({message:a.data.msg,type:"success"}),n.init(),n.details(n.currentDetails)):n.$message.error(a.data.msg),r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(0),n.throughLoading[t]=!1,r.t0;case 13:case"end":return r.stop()}},r,n,[[0,9]])}))).catch(function(){})},rejecte:function(e,t){var n,r=this;this.$prompt("请输入驳回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"请输入驳回理由"}).then((n=o()(i.a.mark(function n(a){var o,s=a.value;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r.rejecteLoading[t]=!0,n.next=4,r.$axios.post("admin/UserAudit/channelReject",{token:r.token,ucp_id:e.ucp_id,uc_id:e.uc_id,reason:s});case 4:o=n.sent,r.rejecteLoading[t]=!1,1==o.data.code?(r.$message({message:o.data.msg,type:"success"}),r.details(r.currentDetails),r.init()):r.$message.error(o.data.msg),n.next=13;break;case 9:throw n.prev=9,n.t0=n.catch(0),r.rejecteLoading[t]=!1,n.t0;case 13:case"end":return n.stop()}},n,r,[[0,9]])})),function(e){return n.apply(this,arguments)})).catch(function(){})},Auth:function(){var e=this,t=this.$route.query.id;this.curId=t,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:t}).then(function(t){if(1==t.data.code){for(var n=t.data.data,r=0;r<n.length;r++)if(n[r].son){"免费保养"==n[r].name&&(e.seCurId=n[r].id,e.threeAuthList=n[r].son);for(var i=0;i<n[r].son.length;i++)n[r].action!=n[r].son[i].action&&(n[r].action=n[r].son[0].action),"二次复核"==n[r].son[i].name&&"免费保养"==n[r].name&&(e.thCurId=n[r].son[i].id)}e.authList=n}else e.$alert(t.data.msg,"提示",{type:"error"})}).catch(function(e){alert(e)})}},mounted:function(){this.Auth(),this.getProvince(),this.getCompany()}},A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ctbHead",e._l(e.authList,function(t){return n("router-link",{key:t.id,class:e.seCurId==t.id?"cur":"",attrs:{to:{path:t.action,query:{id:e.curId}},"v-key":t.id}},[e._v("\n      "+e._s(t.name)+"\n    ")])}),1),e._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"quote"},[e._m(0),e._v(" "),n("div",{staticClass:"quote-nav"},e._l(e.threeAuthList,function(t){return n("router-link",{key:t.id,class:e.thCurId==t.id?"cur":"",attrs:{to:{path:t.action,query:{id:e.curId}}}},[e._v("\n          "+e._s(t.name)+"\n        ")])}),1)]),e._v(" "),n("div",{staticStyle:{margin:"0 20px"}},[n("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择保险公司"},on:{change:function(t){e.page=1,e.init()}},model:{value:e.ListQuery.ucp_company,callback:function(t){e.$set(e.ListQuery,"ucp_company",t)},expression:"ListQuery.ucp_company"}},e._l(e.companyList,function(e,t){return n("el-option",{key:t,attrs:{label:e.company,value:e.id}})}),1),e._v(" "),n("el-date-picker",{staticStyle:{width:"24%","margin-right":"10px"},attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){e.page=1,e.init()}},model:{value:e.pickerSearch,callback:function(t){e.pickerSearch=t},expression:"pickerSearch"}}),e._v("\n      省:\n      "),n("el-select",{staticClass:"region",attrs:{placeholder:"请选择省"},on:{change:e.getCity},model:{value:e.ListQuery.search.province,callback:function(t){e.$set(e.ListQuery.search,"province",t)},expression:"ListQuery.search['province']"}},e._l(e.provincelist,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v("\n      市:\n      "),n("el-select",{staticClass:"region",attrs:{placeholder:"请选择市"},on:{change:e.getCounty},model:{value:e.ListQuery.search.city,callback:function(t){e.$set(e.ListQuery.search,"city",t)},expression:"ListQuery.search['city']"}},e._l(e.citylist,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v("\n      区/县:\n      "),n("el-select",{staticClass:"region",attrs:{placeholder:"请选择区/县"},on:{change:e.changeCounty},model:{value:e.ListQuery.county,callback:function(t){e.$set(e.ListQuery,"county",t)},expression:"ListQuery.county"}},e._l(e.countyList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-table",{attrs:{data:e.list,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{prop:"ucp_company",label:"保险公司名称",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"company",label:"维修厂名称",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"地区",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{placement:"top-start",title:"地区详情",width:"200",trigger:"hover",content:""+t.row.province+t.row.city+t.row.county}},[n("el-button",{staticClass:"ellipsis",attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(""+t.row.province+t.row.city+t.row.county))])],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"复核数量",align:"center",prop:"num"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return e.details(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length>0,expression:"list && list.length>0"}],class:e.list&&e.list.length<=7?"page-nav":"page_center"},[n("paging",{attrs:{"page-count":e.pageCount,page:e.page},on:{index:e.paging}})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"详情",center:"",visible:e.detailsVisible,width:"80%"},on:{"update:visible":function(t){e.detailsVisible=t},close:function(t){e.detailsPage=1,e.detailsCount=1}}},[n("el-table",{staticClass:"detailsTable",attrs:{data:e.detailsList}},[n("el-table-column",{attrs:{align:"center",label:"施工照片"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",e._l(t.row.oil_photo,function(e,t){return n("img",{key:t,ref:"oil_photo",refInFor:!0,attrs:{src:e,width:"50px",height:"50px"}})}),0)]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"plate",label:"车牌号"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"rankers",label:"类型"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"老兵姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(6==t.row.ranker?t.row.old_name:"无")+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"",label:"保单图片/优待证"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.pc_img&&t.row.pc_img.length>0?n("el-button",{attrs:{type:"text"},on:{click:function(n){e.pcImgVisible=!0,e.imgList=t.row.pc_img,e.imgDetails()}}},[e._v("详情")]):n("span",[e._v("无")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"修改时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("datetime")(t.row.audit_time))+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{"min-width":"100px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini",loading:e.throughLoading[t.$index]},on:{click:function(n){return e.through(t.row,t.$index)}}},[e._v("通过")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini",loading:e.rejecteLoading[t.$index]},on:{click:function(n){return e.rejecte(t.row,t.$index)}}},[e._v("驳回")])]}}])})],1),e._v(" "),n("div",{staticClass:"page_center"},[n("paging",{attrs:{"page-count":e.detailsCount,page:e.detailsPage},on:{index:e.detailsPaging}})],1),e._v(" "),n("el-dialog",{attrs:{center:"",title:"保单图片",visible:e.pcImgVisible,"append-to-body":"",width:"25%"},on:{"update:visible":function(t){e.pcImgVisible=t}}},[n("div",e._l(e.imgList,function(e,t){return n("img",{key:t,ref:"img",refInFor:!0,staticStyle:{width:"100px",height:"100px","margin-right":"20px"},attrs:{src:e}})}),0)])],1)],1)};A._withStripped=!0;var h={render:A,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"quote-ele"},[t("i"),this._v("审核-免费保养-二次复核")])}]},g=h;var m=!1;var y=n("VU/8")(d,g,!1,function(e){m||n("WUkP")},"data-v-0872ace8",null);y.options.__file="src/pages/audit/channel/twiceReview.vue";t.default=y.exports}});
//# sourceMappingURL=179.e54f45d7de760de7f6c5.js.map
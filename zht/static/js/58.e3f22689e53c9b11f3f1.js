webpackJsonp([58],{MBB7:function(n,t,e){(n.exports=e("FZ+f")(!0)).push([n.i,'\n.ellipsis[data-v-c4780726] {\n  width: 100px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  margin: 0 auto;\n  text-align: center;\n}\n.search[data-v-c4780726] {\n  width: 15%;\n  margin-right: 10px;\n}\n.region[data-v-c4780726] {\n  width: 10%;\n  margin: 0 10px;\n}\n.img[data-v-c4780726] {\n  width: 70px;\n  height: 70px;\n}\n.images[data-v-c4780726] {\n  width: 100px;\n  height: 100px;\n  margin-right: 10px;\n  vertical-align: top;\n}\n.laybox2 ul[data-v-c4780726] {\n  margin: 33px auto;\n  border-bottom: 1px dashed #04bbfc;\n}\n.laybox2[data-v-c4780726] {\n  padding: 60px;\n  font-size: 16px;\n}\n.laybox2 li[data-v-c4780726] {\n  width: 300px;\n  text-align: left;\n  margin: 33px auto;\n}\n.t-c[data-v-c4780726]:after {\n  content: "";\n  display: block;\n  height: 0;\n  clear: both;\n}\n.bot > div[data-v-c4780726] {\n  position: relative;\n}\ndiv.bot[data-v-c4780726] {\n  margin: 45px auto 35px auto;\n  height: 100px;\n}\ndiv.bot span[data-v-c4780726] {\n  display: inline-block;\n  width: 20%;\n}\ndiv.bot input[data-v-c4780726] {\n  display: inline-block;\n  width: 55%;\n  outline: none;\n  border: none;\n  border-bottom: 1px solid #aaa;\n}\ndiv.bot button[data-v-c4780726] {\n  width: 110px;\n  height: 36px;\n  margin-left: -55px;\n  position: absolute;\n  border-radius: 18px;\n  -webkit-box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\n          box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\n  border: none;\n  color: #fff;\n  left: 50%;\n  top: 60px;\n}\nbutton.reject[data-v-c4780726] {\n  background: rgba(237, 81, 55, 1);\n  margin-right: 30%;\n}\nbutton.pass[data-v-c4780726] {\n  background-color: #20a0ff;\n}\n.left[data-v-c4780726] {\n  float: left;\n  width: 50%;\n}\n.right[data-v-c4780726] {\n  float: right;\n  width: 50%;\n}\n.nowrap[data-v-c4780726] {\n  width: 120px !important;\n  text-align: center;\n  white-space: nowrap; /*规定文本不换行**/\n  text-overflow: ellipsis; /**显示省略符号来代表被修剪的文本。*/\n  overflow: hidden;\n  margin: 0 auto;\n}\n.regionDetail[data-v-c4780726] .el-dialog__title {\n  font-size: 22px;\n}\n.regionDetail[data-v-c4780726] .el-dialog__body {\n  padding: 0px 25px 30px;\n  border-top: solid 2px #eee;\n}\n',"",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/audit/channel/src/pages/audit/channel/unaudited.vue"],names:[],mappings:";AAugBA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA;AACA;EACA,WAAA;EACA,mBAAA;CACA;AACA;EACA,WAAA;EACA,eAAA;CACA;AACA;EACA,YAAA;EACA,aAAA;CACA;AACA;EACA,aAAA;EACA,cAAA;EACA,mBAAA;EACA,oBAAA;CACA;AACA;EACA,kBAAA;EACA,kCAAA;CACA;AAEA;EACA,cAAA;EACA,gBAAA;CACA;AAEA;EACA,aAAA;EACA,iBAAA;EACA,kBAAA;CACA;AAEA;EACA,YAAA;EACA,eAAA;EACA,UAAA;EACA,YAAA;CACA;AAEA;EACA,mBAAA;CACA;AAEA;EACA,4BAAA;EACA,cAAA;CACA;AAEA;EACA,sBAAA;EACA,WAAA;CACA;AAEA;EACA,sBAAA;EACA,WAAA;EACA,cAAA;EACA,aAAA;EACA,8BAAA;CACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,oBAAA;EACA,uDAAA;UAAA,+CAAA;EACA,aAAA;EACA,YAAA;EACA,UAAA;EACA,UAAA;CACA;AAEA;EACA,iCAAA;EACA,kBAAA;CACA;AAEA;EACA,0BAAA;CACA;AAEA;EACA,YAAA;EACA,WAAA;CACA;AACA;EACA,aAAA;EACA,WAAA;CACA;AACA;EACA,wBAAA;EACA,mBAAA;EACA,oBAAA,CAAA,YAAA;EACA,wBAAA,CAAA,qBAAA;EACA,iBAAA;EACA,eAAA;CACA;AACA;EACA,gBAAA;CACA;AACA;EACA,uBAAA;EACA,2BAAA;CACA",file:"unaudited.vue",sourcesContent:['<template>\n  <div>\n    <ctbHead>\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\n                   v-for="item in authList"\n                   :key="item.id"\n                   :to="{path:item.action,query:{id:curId}}"\n                   :v-key="item.id">\n        {{item.name}}\n      </router-link>\n    </ctbHead>\n    <div class="container">\n      <div class="quote">\n        <div class="quote-ele"><i></i>审核-免费保养-复核</div>\n        <div class="quote-nav">\n          <router-link :class="thCurId==item.id? \'cur\':\'\'"\n                       v-for="item in threeAuthList"\n                       :key="item.id"\n                       :to="{path:item.action,query:{id:curId}}">\n            {{item.name}}\n          </router-link>\n        </div>\n      </div>\n      <div style="margin:0 20px">\n        \x3c!-- <el-input placeholder="请输入维修厂"\n                  v-model="ListQuery.company"\n                  class="input-with-select search">\n          <el-button slot="append"\n                     icon="el-icon-search"\n                     @click="page=1,init()"></el-button>\n        </el-input> --\x3e\n        <el-select style="margin-right:10px"\n                   v-model="ListQuery.ucp_company"\n                   placeholder="请选择保险公司"\n                   @change="page=1,init()">\n          <el-option v-for="(item,index) in companyList"\n                     :key="index"\n                     :label="item.company"\n                     :value="item.company"></el-option>\n        </el-select>\n        \x3c!-- <el-date-picker v-model="pickerSearch"\n                        type="daterange"\n                        style="width:24%;margin-right:10px"\n                        @change="page=1,init()"\n                        value-format="yyyy-MM-dd"\n                        range-separator="至"\n                        start-placeholder="开始日期"\n                        end-placeholder="结束日期">\n        </el-date-picker> --\x3e\n        省:\n        <el-select v-model="ListQuery.search[\'province\']"\n                   placeholder="请选择省"\n                   class="region"\n                   @change="page=1,getCity()">\n          <el-option v-for="item in provincelist"\n                     :key="item.id"\n                     :label="item.name"\n                     :value="item.id">\n          </el-option>\n        </el-select>\n        市:\n        <el-select v-model="ListQuery.search[\'city\']"\n                   placeholder="请选择市"\n                   class="region"\n                   @change="page=1,getCounty()">\n          <el-option v-for="item in citylist"\n                     :key="item.id"\n                     :label="item.name"\n                     :value="item.id">\n          </el-option>\n        </el-select>\n        区/县:\n        <el-select v-model="ListQuery.county"\n                   placeholder="请选择区/县"\n                   @change="page=1,changeCounty()"\n                   class="region">\n          <el-option v-for="item in countyList"\n                     :key="item.id"\n                     :label="item.name"\n                     :value="item.id">\n          </el-option>\n        </el-select>\n        \x3c!-- <el-button type="primary"\n                   class="printRight"\n                   @click="print">下载</el-button> --\x3e\n      </div>\n      <el-table :data="list"\n                tooltip-effect="dark">\n        \x3c!-- <el-table-column type="selection"\n                         width="55">\n        </el-table-column> --\x3e\n        <el-table-column label="福利"\n                         align="center"\n                         prop="user_type">\n          <template slot-scope="scope">\n            <el-button type="text"\n                       v-if=\'scope.row.user_type==1\'\n                       @click="details(scope.row)">保险公司</el-button>\n            <span v-else>\n              {{scope.row.user_type==1 ? \'保险公司\' : scope.row.user_type==2 ? \'主机厂\' : \'其他类型\'}}\n            </span>\n          </template>\n        </el-table-column>\n        <el-table-column prop="ucp_company"\n                         label="保险公司名称"\n                         align="center"></el-table-column>\n        <el-table-column prop="company"\n                         label="维修厂名称"\n                         align="center"></el-table-column>\n        <el-table-column prop="phone"\n                         label="联系电话"\n                         align="center"></el-table-column>\n        <el-table-column prop="leader"\n                         label="负责人"\n                         align="center"></el-table-column>\n        <el-table-column label="地区"\n                         align="center">\n\n          <template slot-scope="scope">\n            <el-popover placement="top-start"\n                        title="地区详情"\n                        width="200"\n                        trigger="hover"\n                        :content="`${scope.row.province}${scope.row.city}${scope.row.county}`">\n              <el-button type="text"\n                         slot="reference"\n                         class="ellipsis">{{`${scope.row.province}${scope.row.city}${scope.row.county}`}}</el-button>\n            </el-popover>\n          </template>\n\n        </el-table-column>\n\n        <el-table-column label="销售数量"\n                         align="center"\n                         prop="num">\n\n        </el-table-column>\n\n        <el-table-column label="操作"\n                         align="center">\n          <template slot-scope="scope">\n            <el-button type="primary"\n                       size="mini"\n                       @click="details(scope.row)">详情</el-button>\n\n          </template>\n\n        </el-table-column>\n      </el-table>\n\n      \x3c!-- 分页 --\x3e\n      <div :class="list && list.length<=7?\'page-nav\':\'page_center\'"\n           v-show="list && list.length>0">\n        <paging :page-count="pageCount"\n                :page="page"\n                @index="paging"></paging>\n        \x3c!--分页的组件--\x3e\n      </div>\n    </div>\n    <el-dialog title="详情"\n               center\n               :visible.sync="detailsVisible"\n               width="80%">\n      <el-table :data="detailsList"\n                class="detailsTable">\n        <el-table-column align="center"\n                         prop="ucp_company"\n                         label="保险公司名称">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="name"\n                         label="车辆名称">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="type"\n                         label="车辆类型">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="series"\n                         label="车排量">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="plate"\n                         label="车牌号">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="vin"\n                         label="vin码">\n\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="policy_num"\n                         label="保单号">\n          <template slot-scope="scope">\n            {{scope.row.policy_num || \'无\'}}\n          </template>\n        </el-table-column>\n        <el-table-column align="center"\n                         prop=""\n                         label="保单图片">\n          <template slot-scope="scope">\n\n            <el-button type="text"\n                       v-if="scope.row.pc_img && scope.row.pc_img.length>0"\n                       @click="pcImgVisible=true,imgList=scope.row.pc_img,imgDetails()">详情</el-button>\n            <span v-else>无</span>\n\n          </template>\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="start_time"\n                         label="开始时间">\n          <template slot-scope="scope">\n            {{scope.row.start_time || \'无\'}}\n          </template>\n        </el-table-column>\n        <el-table-column align="center"\n                         prop="end_time"\n                         label="结束时间">\n          <template slot-scope="scope">\n            {{scope.row.end_time || \'无\'}}\n          </template>\n        </el-table-column>\n        <el-table-column min-width="100px"\n                         label="操作"\n                         align="center">\n          <template slot-scope="scope">\n            <el-button type="primary"\n                       size=\'mini\'\n                       :loading="throughLoading[scope.$index]"\n                       @click="through(scope.row,scope.$index)">通过</el-button>\n            <el-button type="danger"\n                       size=\'mini\'\n                       :loading="rejecteLoading[scope.$index]"\n                       @click="rejecte(scope.row,scope.$index)">驳回</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <div class="page_center">\n        <paging :page-count="detailsCount"\n                :page="detailsPage"\n                @index="detailsPaging"></paging>\n        \x3c!--分页的组件--\x3e\n      </div>\n      <el-dialog center\n                 title="保单图片"\n                 :visible.sync="pcImgVisible"\n                 append-to-body\n                 width="25%">\n        <div>\n\n          <img v-for="(item,index) in imgList"\n               style="width:100px;height:100px;margin-right:20px"\n               :key=\'index\'\n               :src="item"\n               ref="img" />\n        </div>\n      </el-dialog>\n    </el-dialog>\n  </div>\n</template>\n<script type="text/ecmascript-6">\nimport Viewer from \'@/utils/Viewer\'\nimport { getPro } from \'@/utils\'\nimport region from \'@/components/common\'\nexport default {\n  data () {\n    return {\n      list: [],\n      token: window.sessionStorage.getItem(\'bbytoken\'),\n      page: 1,\n      pageCount: 1,\n      thCurId: \'\',\n      authList: [],\n      threeAuthList: [],\n      throughLoading: [],\n      rejecteLoading: [],\n      detailsVisible: false,\n      pcImgVisible: false,\n      multipleData: [],\n      detailsList: [],\n      detailsPage: 1,\n      detailsCount: 1,\n      currentDetails: {},\n      ListQuery: {\n        company: \'\',\n        ucp_company: \'平安汽车保险\',\n        start_time: \'\',\n        end_time: \'\',\n        city: \'\',\n        county: \'\',\n        search: []\n      },\n      pickerSearch: "",\n      provincelist: [],\n      citylist: [],\n      countyList: [],\n      companyList: [], //保险公司列表\n      imgList: []\n    }\n  },\n  created () {\n    this.init();\n  },\n  watch: {\n    pickerSearch (val) {   //获取日期\n      if (val) {\n        this.ListQuery.start_time = val[0]\n        this.ListQuery.end_time = val[1]\n      } else {\n        this.ListQuery.start_time = \'\'\n        this.ListQuery.end_time = \'\'\n      }\n    }\n  },\n  methods: {\n    GetCity: region.getCity,\n    GetCounty: region.getCounty,\n    paging (e) {\n      this.page = e;\n      this.init()\n    },\n    detailsPaging (e) {\n      this.detailsPage = e;\n      this.details(this.currentDetails)\n    },\n    init () {\n      this.$axios.post(\'admin/UserAudit/channelList\', Object.assign(this.ListQuery, { token: this.token, page: this.page, status: 0, pay_status: 1, review: 2 }))\n        .then(res => {\n          this.list = res.data.data.list;\n          this.pageCount = res.data.data.rows;\n        }).catch(err => { })\n    },\n    //获取保险公司\n    async getCompany () {\n      try {\n        const res = await this.$axios.post(\'admin/UserAudit/policyCompany\', { token: this.token, type_channel: 1 })\n        this.companyList = res.data.data || []\n      } catch (error) {\n        throw (error)\n      }\n    },\n    //获取全部省\n    async getProvince () {\n      try {\n        const res = await getPro();\n        this.provincelist = res;\n      } catch (error) {\n        throw (error)\n      }\n    },\n    //获取市\n    getCity (id) {\n      this.ListQuery.search[\'province\'] = this.query(this.provincelist, id)\n      this.ListQuery.search[\'city\'] = \'\'  //清空上一次所选的市\n      this.ListQuery.county = \'\'  //清空上一次所选的区/县\n      this.ListQuery.search[\'county_id\'] = \'\'  //清空上一次所选的区/县id\n      this.GetCity(id).then(res => {\n        this.citylist = res\n      })\n      this.init()\n    },\n    //获取 区/县\n    getCounty (id) {\n      this.ListQuery.search[\'city\'] = this.query(this.citylist, id)\n      this.ListQuery.county = \'\' //清空上一次所选的区/县\n      this.ListQuery.search[\'county_id\'] = \'\' //清空上一次所选的区/县id\n      this.GetCounty(id).then(res => {\n        this.countyList = res\n      })\n      this.init()\n    },\n    changeCounty (id) {\n      this.ListQuery.search[\'county_id\'] = id\n      this.init()\n    },\n    //通过 id 查询\n    query (array, id) {  //array 查询的数组  id 通过当前id查询array数组的数据\n      console.log(array)\n      let newArray = array.filter(item => {\n        return item.id == id\n      })\n      return newArray[0].name\n    },\n    async details (row) {  //详情\n      this.detailsVisible = true\n      this.currentDetails = row\n      try {\n        const res = await this.$axios.post("admin/UserAudit/detail", { token: this.token, sid: row.id, policy_id: row.policy_id, status: row.status, page: this.detailsPage })\n        this.detailsList = res.data.data.list || [];\n        this.detailsCount = res.data.data.rows;\n\n      } catch (error) {\n        throw (error)\n      }\n\n    },\n    // handleSelectionChange (val) {  //全选/单选\n    //   let tmp = []\n    //   val.forEach(el => {\n    //     tmp.push({ ucp_id: el.ucp_id, uc_id: el.uc_id, user_type: el.user_type })\n    //   });\n\n    //   this.multipleData = tmp\n    // },\n    imgDetails () {  //保单图片详情\n      this.$nextTick(() => {\n        console.log(this.$refs)\n        const img = this.$refs.img\n        Viewer(img)\n      })\n    },\n    //通过\n    through (item, index) {\n\n      this.$confirm(\'此操作将通过审核, 是否继续?\', \'提示\', {\n        confirmButtonText: \'确定\',\n        cancelButtonText: \'取消\',\n        type: \'warning\',\n        center: true\n      }).then(async () => {\n        try {\n\n          this.throughLoading[index] = true\n          const res = await this.$axios.post(\'admin/UserAudit/channelAdopt\', { token: this.token, ucp_id: item.ucp_id })\n          this.throughLoading[index] = false\n          if (res.data.code == 1) {\n            this.$message({ message: res.data.msg, type: "success" })\n            this.init()\n            this.details(this.currentDetails)\n          } else {\n            this.$message.error(res.data.msg)\n          }\n        } catch (err) {\n          this.throughLoading[index] = false\n          throw (err)\n        }\n      }).catch(() => { });\n    },\n    //驳回\n    rejecte (item, index) {\n\n      this.$prompt(\'请输入驳回理由\', \'提示\', {\n        confirmButtonText: \'确定\',\n        cancelButtonText: \'取消\',\n        inputPattern: /\\S/,\n        inputErrorMessage: \'请输入驳回理由\'\n      }).then(async ({ value }) => {\n        try {\n\n          this.rejecteLoading[index] = true\n          const res = await this.$axios.post(\'admin/UserAudit/channelReject\', { token: this.token, ucp_id: item.ucp_id, uc_id: item.uc_id, reason: value })\n          this.rejecteLoading[index] = false\n          if (res.data.code == 1) {\n            this.$message({ message: res.data.msg, type: "success" })\n            this.details(this.currentDetails)\n            this.init()\n          } else {\n            this.$message.error(res.data.msg)\n          }\n        } catch (err) {\n          this.rejecteLoading[index] = false\n          throw (err)\n        }\n      }).catch(() => { });\n    },\n\n    Auth () {\n      var id = this.$route.query.id;\n      this.curId = id;\n      this.$axios.post(\'admin/Auth/erAuth\', {\n        token: window.sessionStorage.getItem(\'bbytoken\'),\n        id: id\n      })\n        .then(res => {\n\n          if (res.data.code == 1) {\n            var arr = res.data.data;\n            for (var i = 0; i < arr.length; i++) {\n              if (arr[i].son) {\n                if (arr[i].name == \'免费保养\') {\n                  this.seCurId = arr[i].id;\n                  this.threeAuthList = arr[i].son;\n                }\n                for (var j = 0; j < arr[i].son.length; j++) {\n                  if (arr[i].action != arr[i].son[j].action) {\n                    arr[i].action = arr[i].son[0].action;\n                  }\n                  if (arr[i].son[j].name == \'复核\' && arr[i].name == \'免费保养\') {\n                    this.thCurId = arr[i].son[j].id;\n                  }\n                }\n              }\n            }\n            this.authList = arr;\n          } else {\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\n          }\n        })\n        .catch(err => {\n          alert(err);\n        })\n    }\n  },\n  mounted () {\n    this.Auth()\n    this.getProvince()\n    this.getCompany()\n\n  },\n}\n<\/script>\n<style scoped>\n.ellipsis {\n  width: 100px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  margin: 0 auto;\n  text-align: center;\n}\n.search {\n  width: 15%;\n  margin-right: 10px;\n}\n.region {\n  width: 10%;\n  margin: 0 10px;\n}\n.img {\n  width: 70px;\n  height: 70px;\n}\n.images {\n  width: 100px;\n  height: 100px;\n  margin-right: 10px;\n  vertical-align: top;\n}\n.laybox2 ul {\n  margin: 33px auto;\n  border-bottom: 1px dashed #04bbfc;\n}\n\n.laybox2 {\n  padding: 60px;\n  font-size: 16px;\n}\n\n.laybox2 li {\n  width: 300px;\n  text-align: left;\n  margin: 33px auto;\n}\n\n.t-c:after {\n  content: "";\n  display: block;\n  height: 0;\n  clear: both;\n}\n\n.bot > div {\n  position: relative;\n}\n\ndiv.bot {\n  margin: 45px auto 35px auto;\n  height: 100px;\n}\n\ndiv.bot span {\n  display: inline-block;\n  width: 20%;\n}\n\ndiv.bot input {\n  display: inline-block;\n  width: 55%;\n  outline: none;\n  border: none;\n  border-bottom: 1px solid #aaa;\n}\n\ndiv.bot button {\n  width: 110px;\n  height: 36px;\n  margin-left: -55px;\n  position: absolute;\n  border-radius: 18px;\n  box-shadow: 4px 0px 6px rgba(177, 42, 19, 0.2);\n  border: none;\n  color: #fff;\n  left: 50%;\n  top: 60px;\n}\n\nbutton.reject {\n  background: rgba(237, 81, 55, 1);\n  margin-right: 30%;\n}\n\nbutton.pass {\n  background-color: #20a0ff;\n}\n\n.left {\n  float: left;\n  width: 50%;\n}\n.right {\n  float: right;\n  width: 50%;\n}\n.nowrap {\n  width: 120px !important;\n  text-align: center;\n  white-space: nowrap; /*规定文本不换行**/\n  text-overflow: ellipsis; /**显示省略符号来代表被修剪的文本。*/\n  overflow: hidden;\n  margin: 0 auto;\n}\n.regionDetail >>> .el-dialog__title {\n  font-size: 22px;\n}\n.regionDetail >>> .el-dialog__body {\n  padding: 0px 25px 30px;\n  border-top: solid 2px #eee;\n}\n</style>\n'],sourceRoot:""}])},"b7++":function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("Xxa5"),a=e.n(i),r=e("exGp"),o=e.n(r),s=e("woOf"),l=e.n(s),c=e("gPgF"),p=e("0xDb"),u=e("E7z3"),d={data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,thCurId:"",authList:[],threeAuthList:[],throughLoading:[],rejecteLoading:[],detailsVisible:!1,pcImgVisible:!1,multipleData:[],detailsList:[],detailsPage:1,detailsCount:1,currentDetails:{},ListQuery:{company:"",ucp_company:"平安汽车保险",start_time:"",end_time:"",city:"",county:"",search:[]},pickerSearch:"",provincelist:[],citylist:[],countyList:[],companyList:[],imgList:[]}},created:function(){this.init()},watch:{pickerSearch:function(n){n?(this.ListQuery.start_time=n[0],this.ListQuery.end_time=n[1]):(this.ListQuery.start_time="",this.ListQuery.end_time="")}},methods:{GetCity:u.a.getCity,GetCounty:u.a.getCounty,paging:function(n){this.page=n,this.init()},detailsPaging:function(n){this.detailsPage=n,this.details(this.currentDetails)},init:function(){var n=this;this.$axios.post("admin/UserAudit/channelList",l()(this.ListQuery,{token:this.token,page:this.page,status:0,pay_status:1,review:2})).then(function(t){n.list=t.data.data.list,n.pageCount=t.data.data.rows}).catch(function(n){})},getCompany:function(){var n=this;return o()(a.a.mark(function t(){var e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.$axios.post("admin/UserAudit/policyCompany",{token:n.token,type_channel:1});case 3:e=t.sent,n.companyList=e.data.data||[],t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,n,[[0,7]])}))()},getProvince:function(){var n=this;return o()(a.a.mark(function t(){var e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(p.b)();case 3:e=t.sent,n.provincelist=e,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,n,[[0,7]])}))()},getCity:function(n){var t=this;this.ListQuery.search.province=this.query(this.provincelist,n),this.ListQuery.search.city="",this.ListQuery.county="",this.ListQuery.search.county_id="",this.GetCity(n).then(function(n){t.citylist=n}),this.init()},getCounty:function(n){var t=this;this.ListQuery.search.city=this.query(this.citylist,n),this.ListQuery.county="",this.ListQuery.search.county_id="",this.GetCounty(n).then(function(n){t.countyList=n}),this.init()},changeCounty:function(n){this.ListQuery.search.county_id=n,this.init()},query:function(n,t){return console.log(n),n.filter(function(n){return n.id==t})[0].name},details:function(n){var t=this;return o()(a.a.mark(function e(){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.detailsVisible=!0,t.currentDetails=n,e.prev=2,e.next=5,t.$axios.post("admin/UserAudit/detail",{token:t.token,sid:n.id,policy_id:n.policy_id,status:n.status,page:t.detailsPage});case 5:i=e.sent,t.detailsList=i.data.data.list||[],t.detailsCount=i.data.data.rows,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(2),e.t0;case 13:case"end":return e.stop()}},e,t,[[2,10]])}))()},imgDetails:function(){var n=this;this.$nextTick(function(){console.log(n.$refs);var t=n.$refs.img;Object(c.a)(t)})},through:function(n,t){var e=this;this.$confirm("此操作将通过审核, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(o()(a.a.mark(function i(){var r;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,e.throughLoading[t]=!0,i.next=4,e.$axios.post("admin/UserAudit/channelAdopt",{token:e.token,ucp_id:n.ucp_id});case 4:r=i.sent,e.throughLoading[t]=!1,1==r.data.code?(e.$message({message:r.data.msg,type:"success"}),e.init(),e.details(e.currentDetails)):e.$message.error(r.data.msg),i.next=13;break;case 9:throw i.prev=9,i.t0=i.catch(0),e.throughLoading[t]=!1,i.t0;case 13:case"end":return i.stop()}},i,e,[[0,9]])}))).catch(function(){})},rejecte:function(n,t){var e,i=this;this.$prompt("请输入驳回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"请输入驳回理由"}).then((e=o()(a.a.mark(function e(r){var o,s=r.value;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.rejecteLoading[t]=!0,e.next=4,i.$axios.post("admin/UserAudit/channelReject",{token:i.token,ucp_id:n.ucp_id,uc_id:n.uc_id,reason:s});case 4:o=e.sent,i.rejecteLoading[t]=!1,1==o.data.code?(i.$message({message:o.data.msg,type:"success"}),i.details(i.currentDetails),i.init()):i.$message.error(o.data.msg),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),i.rejecteLoading[t]=!1,e.t0;case 13:case"end":return e.stop()}},e,i,[[0,9]])})),function(n){return e.apply(this,arguments)})).catch(function(){})},Auth:function(){var n=this,t=this.$route.query.id;this.curId=t,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:t}).then(function(t){if(1==t.data.code){for(var e=t.data.data,i=0;i<e.length;i++)if(e[i].son){"免费保养"==e[i].name&&(n.seCurId=e[i].id,n.threeAuthList=e[i].son);for(var a=0;a<e[i].son.length;a++)e[i].action!=e[i].son[a].action&&(e[i].action=e[i].son[0].action),"复核"==e[i].son[a].name&&"免费保养"==e[i].name&&(n.thCurId=e[i].son[a].id)}n.authList=e}else n.$alert(t.data.msg,"提示",{type:"error"})}).catch(function(n){alert(n)})}},mounted:function(){this.Auth(),this.getProvince(),this.getCompany()}},A=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("ctbHead",n._l(n.authList,function(t){return e("router-link",{key:t.id,class:n.seCurId==t.id?"cur":"",attrs:{to:{path:t.action,query:{id:n.curId}},"v-key":t.id}},[n._v("\n      "+n._s(t.name)+"\n    ")])}),1),n._v(" "),e("div",{staticClass:"container"},[e("div",{staticClass:"quote"},[n._m(0),n._v(" "),e("div",{staticClass:"quote-nav"},n._l(n.threeAuthList,function(t){return e("router-link",{key:t.id,class:n.thCurId==t.id?"cur":"",attrs:{to:{path:t.action,query:{id:n.curId}}}},[n._v("\n          "+n._s(t.name)+"\n        ")])}),1)]),n._v(" "),e("div",{staticStyle:{margin:"0 20px"}},[e("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择保险公司"},on:{change:function(t){n.page=1,n.init()}},model:{value:n.ListQuery.ucp_company,callback:function(t){n.$set(n.ListQuery,"ucp_company",t)},expression:"ListQuery.ucp_company"}},n._l(n.companyList,function(n,t){return e("el-option",{key:t,attrs:{label:n.company,value:n.company}})}),1),n._v(" "),n._v("\n      省:\n      "),e("el-select",{staticClass:"region",attrs:{placeholder:"请选择省"},on:{change:function(t){n.page=1,n.getCity()}},model:{value:n.ListQuery.search.province,callback:function(t){n.$set(n.ListQuery.search,"province",t)},expression:"ListQuery.search['province']"}},n._l(n.provincelist,function(n){return e("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}),1),n._v("\n      市:\n      "),e("el-select",{staticClass:"region",attrs:{placeholder:"请选择市"},on:{change:function(t){n.page=1,n.getCounty()}},model:{value:n.ListQuery.search.city,callback:function(t){n.$set(n.ListQuery.search,"city",t)},expression:"ListQuery.search['city']"}},n._l(n.citylist,function(n){return e("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}),1),n._v("\n      区/县:\n      "),e("el-select",{staticClass:"region",attrs:{placeholder:"请选择区/县"},on:{change:function(t){n.page=1,n.changeCounty()}},model:{value:n.ListQuery.county,callback:function(t){n.$set(n.ListQuery,"county",t)},expression:"ListQuery.county"}},n._l(n.countyList,function(n){return e("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}),1)],1),n._v(" "),e("el-table",{attrs:{data:n.list,"tooltip-effect":"dark"}},[e("el-table-column",{attrs:{label:"福利",align:"center",prop:"user_type"},scopedSlots:n._u([{key:"default",fn:function(t){return[1==t.row.user_type?e("el-button",{attrs:{type:"text"},on:{click:function(e){return n.details(t.row)}}},[n._v("保险公司")]):e("span",[n._v("\n            "+n._s(1==t.row.user_type?"保险公司":2==t.row.user_type?"主机厂":"其他类型")+"\n          ")])]}}])}),n._v(" "),e("el-table-column",{attrs:{prop:"ucp_company",label:"保险公司名称",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"company",label:"维修厂名称",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"phone",label:"联系电话",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"leader",label:"负责人",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"地区",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-popover",{attrs:{placement:"top-start",title:"地区详情",width:"200",trigger:"hover",content:""+t.row.province+t.row.city+t.row.county}},[e("el-button",{staticClass:"ellipsis",attrs:{slot:"reference",type:"text"},slot:"reference"},[n._v(n._s(""+t.row.province+t.row.city+t.row.county))])],1)]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"销售数量",align:"center",prop:"num"}}),n._v(" "),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return n.details(t.row)}}},[n._v("详情")])]}}])})],1),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.list&&n.list.length>0,expression:"list && list.length>0"}],class:n.list&&n.list.length<=7?"page-nav":"page_center"},[e("paging",{attrs:{"page-count":n.pageCount,page:n.page},on:{index:n.paging}})],1)],1),n._v(" "),e("el-dialog",{attrs:{title:"详情",center:"",visible:n.detailsVisible,width:"80%"},on:{"update:visible":function(t){n.detailsVisible=t}}},[e("el-table",{staticClass:"detailsTable",attrs:{data:n.detailsList}},[e("el-table-column",{attrs:{align:"center",prop:"ucp_company",label:"保险公司名称"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"name",label:"车辆名称"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"type",label:"车辆类型"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"series",label:"车排量"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"plate",label:"车牌号"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"vin",label:"vin码"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"policy_num",label:"保单号"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(t.row.policy_num||"无")+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"",label:"保单图片"},scopedSlots:n._u([{key:"default",fn:function(t){return[t.row.pc_img&&t.row.pc_img.length>0?e("el-button",{attrs:{type:"text"},on:{click:function(e){n.pcImgVisible=!0,n.imgList=t.row.pc_img,n.imgDetails()}}},[n._v("详情")]):e("span",[n._v("无")])]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"start_time",label:"开始时间"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(t.row.start_time||"无")+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",prop:"end_time",label:"结束时间"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(t.row.end_time||"无")+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{"min-width":"100px",label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini",loading:n.throughLoading[t.$index]},on:{click:function(e){return n.through(t.row,t.$index)}}},[n._v("通过")]),n._v(" "),e("el-button",{attrs:{type:"danger",size:"mini",loading:n.rejecteLoading[t.$index]},on:{click:function(e){return n.rejecte(t.row,t.$index)}}},[n._v("驳回")])]}}])})],1),n._v(" "),e("div",{staticClass:"page_center"},[e("paging",{attrs:{"page-count":n.detailsCount,page:n.detailsPage},on:{index:n.detailsPaging}})],1),n._v(" "),e("el-dialog",{attrs:{center:"",title:"保单图片",visible:n.pcImgVisible,"append-to-body":"",width:"25%"},on:{"update:visible":function(t){n.pcImgVisible=t}}},[e("div",n._l(n.imgList,function(n,t){return e("img",{key:t,ref:"img",refInFor:!0,staticStyle:{width:"100px",height:"100px","margin-right":"20px"},attrs:{src:n}})}),0)])],1)],1)};A._withStripped=!0;var h={render:A,staticRenderFns:[function(){var n=this.$createElement,t=this._self._c||n;return t("div",{staticClass:"quote-ele"},[t("i"),this._v("审核-免费保养-复核")])}]},g=h;var m=!1;var y=e("VU/8")(d,g,!1,function(n){m||e("cpDE")},"data-v-c4780726",null);y.options.__file="src/pages/audit/channel/unaudited.vue";t.default=y.exports},cpDE:function(n,t,e){var i=e("MBB7");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);e("rjj0")("0765d6f9",i,!1,{})}});
//# sourceMappingURL=58.e3f22689e53c9b11f3f1.js.map
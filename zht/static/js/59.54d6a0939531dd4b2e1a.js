webpackJsonp([59],{BXX1:function(t,n,e){(t.exports=e("FZ+f")(!0)).push([t.i,"\n.quote[data-v-bced4922] {\n  margin: 30px 0;\n}\n.selectCity[data-v-bced4922] {\n  margin: 20px 0 0 20px;\n}\n.myPage[data-v-bced4922] {\n  text-align: center;\n  margin: 20px 0;\n}\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/components/shoplist/src/components/shoplist/region.vue"],names:[],mappings:";AAiQA;EACA,eAAA;CACA;AACA;EACA,sBAAA;CACA;AACA;EACA,mBAAA;EACA,eAAA;CACA",file:"region.vue",sourcesContent:['<template>\n  <div>\n    <ctbHead>\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\n                   v-for="item in authList"\n                   :key="item.id"\n                   :to="{path:item.action,query:{id:curId}}">{{item.name}}\n      </router-link>\n    </ctbHead>\n    <div class="container">\n      <div class="selectCity">\n        <span>选择省: </span>\n        <el-select v-model="provinceId"\n                   placeholder="请选择所在省"\n                   @change="handleProChange">\n          <el-option v-for="item in provinceList"\n                     :key="item.id"\n                     :name="item.name"\n                     :value="item.id"\n                     :label="item.name">\n          </el-option>\n        </el-select>\n        <span>选择市: </span>\n        <el-select v-model="cityId"\n                   placeholder="请选择所在市"\n                   @change="handleCityChange">\n          <el-option v-for="item in cityList"\n                     :key="item.id"\n                     :name="item.name"\n                     :value="item.id"\n                     :label="item.name">\n          </el-option>\n        </el-select>\n      </div>\n      <div class="cityData"\n           align="center">\n        <el-table :data="cityData"\n                  style="width: 100%">\n          <el-table-column align="center"\n                           prop="name"\n                           label="县级名称">\n          </el-table-column>\n          <el-table-column align="center"\n                           prop="complete"\n                           label="数量">\n          </el-table-column>\n          <el-table-column align="center"\n                           prop="completed"\n                           label="已开发数量">\n          </el-table-column>\n          <el-table-column align="center"\n                           prop="open_status"\n                           label="是否开放">\n            <template slot-scope="scope">\n              <el-button type="default"\n                         disabled="disabled"\n                         v-if="scope.row.open_status==1">\n                已开放\n              </el-button>\n              <el-button @click="isModifyState(scope.row.id)"\n                         type="primary"\n                         size="small"\n                         v-else-if="scope.row.open_status==2">\n                未开放\n              </el-button>\n              <el-button type="default"\n                         disabled="disabled"\n                         size="small"\n                         v-else-if="scope.row.open_status==3">\n                数量未达到上限\n              </el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </div>\n      <el-pagination background\n                     layout="prev, pager, next"\n                     :total="rows"\n                     class="myPage"\n                     :current-page.sync="currentPage"\n                     @current-change="handleCurrentPage">\n      </el-pagination>\n    </div>\n  </div>\n</template>\n<script type="text/ecmascript-6">\n\nexport default {\n  data () {\n    return {\n      list: [],\n      authList: [],\n      seCurId: \'\',\n      token: window.sessionStorage.getItem(\'bbytoken\'),\n      provinceList: [],  //省数据\n      cityList: [],\t\t\t//市数据\n      provinceId: \'\',    //选中的省ID\n      cityId: \'\',\t\t\t\t//选中的市ID\n      cityData: [],      //列表\n      currentPage: 1,    //当前页\n      rows: 100\t\t\t\t\t//默认页数\n    }\n  },\n  methods: {\n\n    // 省接口 agent/reg/regPro\n\n    // id市接口  agent/reg/regCity \n\n    ProvinceDate () {  //省数据\n      this.$axios.get(\'agent/reg/regPro\')\n        .then(res => {\n          var prolist = res.data;\n          if (prolist) {\n            this.provinceList = prolist\n          }\n        })\n        .catch(err => {\n          alert(err + "省数据获取失败")\n        })\n    },\n    handleProChange () {\n      var _this = this\n      this.$axios.post(\'agent/reg/regCity\', {\n        id: _this.provinceId\n      })\n        .then(res => {\n          var citylist = res.data;\n          this.cityList = citylist\n        })\n        .catch(err => {\n          alert(err + "市数据获取失败")\n        })\n    },\n\n    handleCityChange () {\n      this.$axios.post(\'admin/ShopRegionNum/index\', {\n        token: window.sessionStorage.getItem(\'bbytoken\'),\n        city: this.cityId,\n        page: this.currentPage\n      })\n        .then((res) => {\n          var citydata = res.data.data.list;\n          this.rows = res.data.data.rows * 10\n          if (citydata) {\n            this.cityData = citydata;\n          }\n        })\n        .catch((err) => {\n          alert(err + "cityData获取失败")\n        })\n    },\n\n    isModifyState (val) {\n      var _this = this\n      this.$confirm(\'确定修改开放状态吗?\', \'提示\', {\n        confirmButtonText: \'确定\',\n        cancelButtonText: \'取消\',\n        type: \'warning\'\n      }).then(() => {\n        this.$axios.post(\'admin/ShopRegionNum/openStatus\', {\n          token: window.sessionStorage.getItem(\'bbytoken\'),\n          id: val\n        })\n          .then((res) => {\n            _this.$axios.post(\'admin/ShopRegionNum/index\', {\n              token: window.sessionStorage.getItem(\'bbytoken\'),\n              city: _this.cityId,\n              page: _this.currentPage\n            })\n              .then((res) => {\n                var citydata = res.data.data.list;\n                if (citydata) {\n                  _this.cityData = citydata;\n                }\n              })\n              .catch((err) => {\n                alert(err + "cityData获取失败")\n              })\n            this.$message({\n              type: \'success\',\n              message: \'修改成功!\'\n            });\n          })\n          .catch((err) => {\n            this.$message({\n              type: \'info\',\n              message: \'修改失败\'\n            });\n          })\n      }).catch(() => {\n        this.$message({\n          type: \'info\',\n          message: \'取消修改\'\n        });\n      });\n    },\n\n    handleCurrentPage () {  //分页处理\n      this.$axios.post(\'admin/ShopRegionNum/index\', {\n        token: window.sessionStorage.getItem(\'bbytoken\'),\n        city: this.cityId,\n        page: this.currentPage\n      })\n        .then((res) => {\n          var citydata = res.data.data.list;\n          if (citydata) {\n            this.cityData = citydata;\n          }\n        })\n        .catch((err) => {\n          alert(err + "cityData获取失败")\n        })\n    },\n\n    Auth () { //权限\n      var id = this.$route.query.id;\n      this.curId = id;\n      this.$axios.post(\'admin/Auth/erAuth\', {\n        token: window.sessionStorage.getItem(\'bbytoken\'),\n        id: id\n      })\n        .then(res => {\n          if (res.data.code == 1) {\n            var arr = res.data.data;\n            for (var i = 0; i < arr.length; i++) {\n              if (arr[i].name == \'地区数量\') {\n                this.seCurId = arr[i].id;\n              }\n              if (arr[i].son) {\n                for (var j = 0; j < arr[i].son.length; j++) {\n                  if (arr[i].action != arr[i].son[j].action) {\n                    arr[i].action = arr[i].son[0].action;\n                  }\n                }\n              }\n            }\n            this.authList = arr;\n          } else {\n            this.$alert(res.data.msg, \'提示\', {\n              type: \'error\'\n            });\n          }\n        })\n        .catch(err => {\n          alert(err);\n        })\n    }\n  },\n  mounted () {\n    this.Auth()\n    this.ProvinceDate()\n  },\n\n}\n<\/script>\n<style scoped>\n.quote {\n  margin: 30px 0;\n}\n.selectCity {\n  margin: 20px 0 0 20px;\n}\n.myPage {\n  text-align: center;\n  margin: 20px 0;\n}\n</style>\n'],sourceRoot:""}])},Ef4Q:function(t,n,e){var a=e("BXX1");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("546b29f2",a,!1,{})},Hs3h:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={data:function(){return{list:[],authList:[],seCurId:"",token:window.sessionStorage.getItem("bbytoken"),provinceList:[],cityList:[],provinceId:"",cityId:"",cityData:[],currentPage:1,rows:100}},methods:{ProvinceDate:function(){var t=this;this.$axios.get("agent/reg/regPro").then(function(n){var e=n.data;e&&(t.provinceList=e)}).catch(function(t){alert(t+"省数据获取失败")})},handleProChange:function(){var t=this;this.$axios.post("agent/reg/regCity",{id:this.provinceId}).then(function(n){var e=n.data;t.cityList=e}).catch(function(t){alert(t+"市数据获取失败")})},handleCityChange:function(){var t=this;this.$axios.post("admin/ShopRegionNum/index",{token:window.sessionStorage.getItem("bbytoken"),city:this.cityId,page:this.currentPage}).then(function(n){var e=n.data.data.list;t.rows=10*n.data.data.rows,e&&(t.cityData=e)}).catch(function(t){alert(t+"cityData获取失败")})},isModifyState:function(t){var n=this,e=this;this.$confirm("确定修改开放状态吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.$axios.post("admin/ShopRegionNum/openStatus",{token:window.sessionStorage.getItem("bbytoken"),id:t}).then(function(t){e.$axios.post("admin/ShopRegionNum/index",{token:window.sessionStorage.getItem("bbytoken"),city:e.cityId,page:e.currentPage}).then(function(t){var n=t.data.data.list;n&&(e.cityData=n)}).catch(function(t){alert(t+"cityData获取失败")}),n.$message({type:"success",message:"修改成功!"})}).catch(function(t){n.$message({type:"info",message:"修改失败"})})}).catch(function(){n.$message({type:"info",message:"取消修改"})})},handleCurrentPage:function(){var t=this;this.$axios.post("admin/ShopRegionNum/index",{token:window.sessionStorage.getItem("bbytoken"),city:this.cityId,page:this.currentPage}).then(function(n){var e=n.data.data.list;e&&(t.cityData=e)}).catch(function(t){alert(t+"cityData获取失败")})},Auth:function(){var t=this,n=this.$route.query.id;this.curId=n,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:n}).then(function(n){if(1==n.data.code){for(var e=n.data.data,a=0;a<e.length;a++)if("地区数量"==e[a].name&&(t.seCurId=e[a].id),e[a].son)for(var i=0;i<e[a].son.length;i++)e[a].action!=e[a].son[i].action&&(e[a].action=e[a].son[0].action);t.authList=e}else t.$alert(n.data.msg,"提示",{type:"error"})}).catch(function(t){alert(t)})}},mounted:function(){this.Auth(),this.ProvinceDate()}},i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("ctbHead",t._l(t.authList,function(n){return e("router-link",{key:n.id,class:t.seCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:t.curId}}}},[t._v(t._s(n.name)+"\n    ")])}),1),t._v(" "),e("div",{staticClass:"container"},[e("div",{staticClass:"selectCity"},[e("span",[t._v("选择省: ")]),t._v(" "),e("el-select",{attrs:{placeholder:"请选择所在省"},on:{change:t.handleProChange},model:{value:t.provinceId,callback:function(n){t.provinceId=n},expression:"provinceId"}},t._l(t.provinceList,function(t){return e("el-option",{key:t.id,attrs:{name:t.name,value:t.id,label:t.name}})}),1),t._v(" "),e("span",[t._v("选择市: ")]),t._v(" "),e("el-select",{attrs:{placeholder:"请选择所在市"},on:{change:t.handleCityChange},model:{value:t.cityId,callback:function(n){t.cityId=n},expression:"cityId"}},t._l(t.cityList,function(t){return e("el-option",{key:t.id,attrs:{name:t.name,value:t.id,label:t.name}})}),1)],1),t._v(" "),e("div",{staticClass:"cityData",attrs:{align:"center"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.cityData}},[e("el-table-column",{attrs:{align:"center",prop:"name",label:"县级名称"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"complete",label:"数量"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"completed",label:"已开发数量"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"open_status",label:"是否开放"},scopedSlots:t._u([{key:"default",fn:function(n){return[1==n.row.open_status?e("el-button",{attrs:{type:"default",disabled:"disabled"}},[t._v("\n              已开放\n            ")]):2==n.row.open_status?e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.isModifyState(n.row.id)}}},[t._v("\n              未开放\n            ")]):3==n.row.open_status?e("el-button",{attrs:{type:"default",disabled:"disabled",size:"small"}},[t._v("\n              数量未达到上限\n            ")]):t._e()]}}])})],1)],1),t._v(" "),e("el-pagination",{staticClass:"myPage",attrs:{background:"",layout:"prev, pager, next",total:t.rows,"current-page":t.currentPage},on:{"update:currentPage":function(n){t.currentPage=n},"update:current-page":function(n){t.currentPage=n},"current-change":t.handleCurrentPage}})],1)],1)};i._withStripped=!0;var s={render:i,staticRenderFns:[]},r=s;var o=!1;var c=e("VU/8")(a,r,!1,function(t){o||e("Ef4Q")},"data-v-bced4922",null);c.options.__file="src/components/shoplist/region.vue";n.default=c.exports}});
//# sourceMappingURL=59.54d6a0939531dd4b2e1a.js.map
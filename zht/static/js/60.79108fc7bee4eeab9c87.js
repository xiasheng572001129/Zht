webpackJsonp([60],{IC2t:function(t,n,r){var e=r("NNlW");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);r("rjj0")("24871c39",e,!1,{})},NNlW:function(t,n,r){(t.exports=r("FZ+f")(!0)).push([t.i,"\n.car_img[data-v-cdd88928] {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\n}\n.details > div[data-v-cdd88928] {\r\n  margin: 10px 0;\n}\n.details span[data-v-cdd88928]:first-child {\r\n  width: 100px;\r\n  text-align: right;\r\n  display: inline-block;\n}\n.img[data-v-cdd88928] {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/audit/serviceCode/src/pages/audit/serviceCode/unaudited.vue"],names:[],mappings:";AA0LA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,eAAA;CACA;AACA;EACA,eAAA;CACA;AACA;EACA,aAAA;EACA,kBAAA;EACA,sBAAA;CACA;AACA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,eAAA;CACA",file:"unaudited.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele"><i></i>服务工号-未审核</div>\r\n        <div class="quote-nav">\r\n          <router-link :class="thCurId==item.id? \'cur\':\'\'"\r\n                       v-for="item in threeAuthList"\r\n                       :key="item.id"\r\n                       :to="{path:item.action,query:{id:curId}}">\r\n            {{item.name}}\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n      <el-table :data="list">\r\n        <el-table-column align="center"\r\n                         label="用户姓名"\r\n                         prop="name"></el-table-column>\r\n        <el-table-column align="center"\r\n                         label="用户电话"\r\n                         prop="phone"></el-table-column>\r\n        <el-table-column align="center"\r\n                         label="申请时间"\r\n                         prop="create_time"></el-table-column>\r\n        <el-table-column align="center"\r\n                         label="操作">\r\n          <template slot-scope="scope">\r\n            <el-button type="primary"\r\n                       size="small"\r\n                       :loading="throughLoading[scope.$index]"\r\n                       @click="through(scope.row,scope.$index)">通过</el-button>\r\n            <el-button type="danger"\r\n                       size="small"\r\n                       :loading="rejectLoading[scope.$index]"\r\n                       @click="reject(scope.row,scope.$index)">驳回</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class="page_center"\r\n           v-show="pageCount&&pageCount>1">\r\n        <paging :page-count="pageCount"\r\n                :page="page"\r\n                @index="paging"></paging>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\n//  import page from \'../common.js\';\r\nimport Viewer from \'@/utils/Viewer\'\r\nexport default {\r\n  data () {\r\n    return {\r\n      authList: [],\r\n      threeAuthList: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      seCurId: 0,\r\n      page: 0,\r\n      pageCount: 0,\r\n      list: [],\r\n      detailsVisible: false,\r\n      detailsList: {},\r\n      throughLoading: [], //通过loading\r\n      rejectLoading: [],//驳回loading\r\n    }\r\n  },\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    async init () {\r\n      try {\r\n        const res = await this.$axios.post(\'admin/UserAudit/serviceCode\', { token: this.token, page: this.page, status: 0 })\r\n        this.list = res.data.data.list || []\r\n        this.pageCount = res.data.data.rows || 0;\r\n      } catch (err) {\r\n        throw (err)\r\n      }\r\n    },\r\n    through (item, index) {  //通过\r\n      this.$confirm(\'此操作通过审核, 是否继续?\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        type: \'warning\'\r\n      }).then(async () => {\r\n        try {\r\n          this.throughLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/UserAudit/serviceAudit\', { token: this.token, uid: item.uid }) //uid 用户id\r\n          this.throughLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: \'success\' })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (error) {\r\n          this.throughLoading[index] = false\r\n          throw (error)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n    reject (item, index) {  //驳回\r\n      this.$prompt(\'请输入驳回理由\', \'提示\', {\r\n        confirmButtonText: \'确定\',\r\n        cancelButtonText: \'取消\',\r\n        inputPattern: /\\S/,\r\n        inputErrorMessage: \'驳回理由不能为空\'\r\n      }).then(async ({ value }) => {\r\n        try {\r\n          this.rejectLoading[index] = true\r\n          const res = await this.$axios.post(\'admin/UserAudit/serviceReject\', { token: this.token, uid: item.uid, reason: value })  //uid 用户id  reason-驳回理由\r\n          this.rejectLoading[index] = false\r\n          if (res.data.code == 1) {\r\n            this.$message({ message: res.data.msg, type: \'success\' })\r\n            this.init()\r\n          } else {\r\n            this.$message.error(res.data.msg)\r\n          }\r\n        } catch (error) {\r\n          this.rejectLoading[index] = false\r\n          throw (error)\r\n        }\r\n      }).catch(() => { });\r\n    },\r\n    erAuth () { //权限列表\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: this.token,\r\n        id: id\r\n      })\r\n        .then(res => {\r\n\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n\r\n              if (arr[i].name == \'服务工号\') {\r\n                this.seCurId = arr[i].id;\r\n\r\n                if (arr[i].son) {\r\n\r\n                  this.threeAuthList = arr[i].son;\r\n                  for (var j = 0; j < arr[i].son.length; j++) {\r\n                    if (arr[i].action != arr[i].son[j].action) {\r\n                      arr[i].action = arr[i].son[0].action;\r\n                    }\r\n                    if (arr[i].son[j].name == \'未审核\' && arr[i].name == \'服务工号\') {\r\n                      this.thCurId = arr[i].son[j].id;\r\n                    }\r\n\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n\r\n  mounted () {\r\n    this.init()\r\n    this.erAuth()\r\n  },\r\n\r\n}\r\n<\/script>\r\n<style scoped>\r\n.car_img {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\r\n}\r\n.details > div {\r\n  margin: 10px 0;\r\n}\r\n.details span:first-child {\r\n  width: 100px;\r\n  text-align: right;\r\n  display: inline-block;\r\n}\r\n.img {\r\n  width: 50px;\r\n  height: 50px;\r\n  vertical-align: middle;\r\n  margin: 10px 0;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},sQa8:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=r("Xxa5"),i=r.n(e),a=r("exGp"),s=r.n(a),o=(r("gPgF"),{data:function(){return{authList:[],threeAuthList:[],token:window.sessionStorage.getItem("bbytoken"),seCurId:0,page:0,pageCount:0,list:[],detailsVisible:!1,detailsList:{},throughLoading:[],rejectLoading:[]}},methods:{paging:function(t){this.page=t,this.init()},init:function(){var t=this;return s()(i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$axios.post("admin/UserAudit/serviceCode",{token:t.token,page:t.page,status:0});case 3:r=n.sent,t.list=r.data.data.list||[],t.pageCount=r.data.data.rows||0,n.next=11;break;case 8:throw n.prev=8,n.t0=n.catch(0),n.t0;case 11:case"end":return n.stop()}},n,t,[[0,8]])}))()},through:function(t,n){var r=this;this.$confirm("此操作通过审核, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.throughLoading[n]=!0,e.next=4,r.$axios.post("admin/UserAudit/serviceAudit",{token:r.token,uid:t.uid});case 4:a=e.sent,r.throughLoading[n]=!1,1==a.data.code?(r.$message({message:a.data.msg,type:"success"}),r.init()):r.$message.error(a.data.msg),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),r.throughLoading[n]=!1,e.t0;case 13:case"end":return e.stop()}},e,r,[[0,9]])}))).catch(function(){})},reject:function(t,n){var r,e=this;this.$prompt("请输入驳回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"驳回理由不能为空"}).then((r=s()(i.a.mark(function r(a){var s,o=a.value;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e.rejectLoading[n]=!0,r.next=4,e.$axios.post("admin/UserAudit/serviceReject",{token:e.token,uid:t.uid,reason:o});case 4:s=r.sent,e.rejectLoading[n]=!1,1==s.data.code?(e.$message({message:s.data.msg,type:"success"}),e.init()):e.$message.error(s.data.msg),r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(0),e.rejectLoading[n]=!1,r.t0;case 13:case"end":return r.stop()}},r,e,[[0,9]])})),function(t){return r.apply(this,arguments)})).catch(function(){})},erAuth:function(){var t=this,n=this.$route.query.id;this.curId=n,this.$axios.post("admin/Auth/erAuth",{token:this.token,id:n}).then(function(n){if(1==n.data.code){for(var r=n.data.data,e=0;e<r.length;e++)if("服务工号"==r[e].name&&(t.seCurId=r[e].id,r[e].son)){t.threeAuthList=r[e].son;for(var i=0;i<r[e].son.length;i++)r[e].action!=r[e].son[i].action&&(r[e].action=r[e].son[0].action),"未审核"==r[e].son[i].name&&"服务工号"==r[e].name&&(t.thCurId=r[e].son[i].id)}t.authList=r}else t.$alert(n.data.msg,"提示",{type:"error"})}).catch(function(t){alert(t)})}},mounted:function(){this.init(),this.erAuth()}}),c=function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",[r("ctbHead",t._l(t.authList,function(n){return r("router-link",{key:n.id,class:t.seCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:t.curId}},"v-key":n.id}},[t._v("\n      "+t._s(n.name)+"\n    ")])}),1),t._v(" "),r("div",{staticClass:"container"},[r("div",{staticClass:"quote"},[t._m(0),t._v(" "),r("div",{staticClass:"quote-nav"},t._l(t.threeAuthList,function(n){return r("router-link",{key:n.id,class:t.thCurId==n.id?"cur":"",attrs:{to:{path:n.action,query:{id:t.curId}}}},[t._v("\n          "+t._s(n.name)+"\n        ")])}),1)]),t._v(" "),r("el-table",{attrs:{data:t.list}},[r("el-table-column",{attrs:{align:"center",label:"用户姓名",prop:"name"}}),t._v(" "),r("el-table-column",{attrs:{align:"center",label:"用户电话",prop:"phone"}}),t._v(" "),r("el-table-column",{attrs:{align:"center",label:"申请时间",prop:"create_time"}}),t._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[r("el-button",{attrs:{type:"primary",size:"small",loading:t.throughLoading[n.$index]},on:{click:function(r){return t.through(n.row,n.$index)}}},[t._v("通过")]),t._v(" "),r("el-button",{attrs:{type:"danger",size:"small",loading:t.rejectLoading[n.$index]},on:{click:function(r){return t.reject(n.row,n.$index)}}},[t._v("驳回")])]}}])})],1),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.pageCount&&t.pageCount>1,expression:"pageCount&&pageCount>1"}],staticClass:"page_center"},[r("paging",{attrs:{"page-count":t.pageCount,page:t.page},on:{index:t.paging}})],1)],1)],1)};c._withStripped=!0;var d={render:c,staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"quote-ele"},[n("i"),this._v("服务工号-未审核")])}]},u=d;var l=!1;var h=r("VU/8")(o,u,!1,function(t){l||r("IC2t")},"data-v-cdd88928",null);h.options.__file="src/pages/audit/serviceCode/unaudited.vue";n.default=h.exports}});
//# sourceMappingURL=60.79108fc7bee4eeab9c87.js.map
webpackJsonp([90],{"7Wit":function(t,e,r){(t.exports=r("FZ+f")(!0)).push([t.i,"\n.ellipsis[data-v-71e54e54] {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\n}\n.tree[data-v-71e54e54] {\r\n  margin-left: 5%;\n}\n.treeRadio[data-v-71e54e54] {\r\n  position: absolute;\r\n  left: 20%;\n}\r\n","",{version:3,sources:["F:/仲达集团/2020-3-18总后台管理系统/src/pages/filterSetup/src/pages/filterSetup/index.vue"],names:[],mappings:";AAqKA;EACA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,qBAAA;EACA,6BAAA;EACA,sBAAA;EACA,eAAA;EACA,mBAAA;CACA;AACA;EACA,gBAAA;CACA;AACA;EACA,mBAAA;EACA,UAAA;CACA",file:"index.vue",sourcesContent:['<template>\r\n  <div>\r\n    <ctbHead>\r\n      <router-link :class="seCurId==item.id? \'cur\':\'\'"\r\n                   v-for="item in authList"\r\n                   :key="item.id"\r\n                   :to="{path:item.action,query:{id:curId}}"\r\n                   :v-key="item.id">\r\n        {{item.name}}\r\n      </router-link>\r\n    </ctbHead>\r\n    <div class="container">\r\n      <div class="quote">\r\n        <div class="quote-ele">\r\n          <i></i>\r\n          滤芯设置\r\n        </div>\r\n      </div>\r\n      <el-tree :data="treeData"\r\n               node-key="id"\r\n               default-expand-all\r\n               :expand-on-click-node="false"\r\n               class="tree">\r\n        <span class="custom-tree-node"\r\n              slot-scope="{ node ,data}">\r\n          {{data.name}}\r\n          <span v-if="data.level!=1"\r\n                class="treeRadio">\r\n            <el-radio-group v-model="data.status"\r\n                            @change="(value)=>radioChange(data,value)">\r\n              <el-radio :label="2">维修厂</el-radio>\r\n              <el-radio :label="1">供应商</el-radio>\r\n            </el-radio-group>\r\n            <span style="margin-left:20px"\r\n                  v-if="data.status==1">\r\n              滤芯补贴 : {{data.money}}元\r\n            </span>\r\n          </span>\r\n        </span>\r\n      </el-tree>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n<script type="text/ecmascript-6">\r\nimport { getPro, GET_City } from \'@/utils\'   //获取省市\r\nexport default {\r\n  data () {\r\n    return {\r\n      list: [],\r\n      token: window.sessionStorage.getItem(\'bbytoken\'),\r\n      //分页数据\r\n      page: 1, //显示的页码数\r\n      pageCount: 1,\r\n      curId: 0,\r\n      thCurId: 0,\r\n      seCurId: 0,\r\n      threeAuthList: [],\r\n      authList: [],\r\n      treeData: [], //滤芯设置列表\r\n\r\n    }\r\n  },\r\n\r\n\r\n  methods: {\r\n    paging (e) {\r\n      this.page = e;\r\n      this.init()\r\n    },\r\n    async init () {\r\n      try {\r\n        const res = await this.$axios.post("admin/SystemSetup/filterList", { token: this.token })\r\n        let treeData = res.data.data\r\n        treeData.forEach(element => {\r\n          element.children.forEach(item => {\r\n            if (!item.status) {\r\n              item = Object.assign(item, { status: 2 })\r\n            }\r\n          })\r\n        });\r\n        this.treeData = treeData\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n    radioChange (item, status) {\r\n      if (status == 1) {\r\n        this.$prompt(\'请输入滤芯补贴\', \'提示\', {\r\n          confirmButtonText: \'确定\',\r\n          cancelButtonText: \'取消\',\r\n          inputPattern: /\\S/,\r\n          inputErrorMessage: \'请输入滤芯补贴\',\r\n          closeOnClickModal: false,\r\n          beforeClose: (action, instance, done) => {\r\n            if (action == \'confirm\') {\r\n              let value = instance.inputValue;\r\n              this.filterSet(item.id, status, value, done())\r\n            } else {\r\n              item.status = 2\r\n              done()\r\n            }\r\n          }\r\n        }).then(() => { }).catch(() => { })\r\n      } else {\r\n        this.filterSet(item.id, status)\r\n      }\r\n    },\r\n\r\n    async filterSet (cid, status, money, callback) {  //设置滤芯\r\n      try {\r\n        const res = await this.$axios.post("admin/SystemSetup/filterSet", { token: this.token, cid: cid, status: status, money: money })\r\n        if (res.data.code == 1) {\r\n          this.$message({ message: res.data.msg, type: "success" })\r\n          this.init()\r\n          callback && callback()\r\n        } else {\r\n          this.$message.error(res.data.msg)\r\n        }\r\n      } catch (error) {\r\n        throw (error)\r\n      }\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n    Auth () {  //权限列表\r\n      var id = this.$route.query.id;\r\n      this.curId = id;\r\n      this.$axios.post(\'admin/Auth/erAuth\', {\r\n        token: window.sessionStorage.getItem(\'bbytoken\'),\r\n        id: id\r\n      })\r\n        .then(res => {\r\n          if (res.data.code == 1) {\r\n            var arr = res.data.data;\r\n            for (var i = 0; i < arr.length; i++) {\r\n              if (arr[i].son) {\r\n                if (arr[i].name == \'滤芯设置\') {\r\n                  this.seCurId = arr[i].id;\r\n                  this.threeAuthList = arr[i].son;\r\n                }\r\n\r\n              }\r\n            }\r\n            this.authList = arr;\r\n          } else {\r\n            this.$alert(res.data.msg, \'提示\', { type: \'error\' });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.Auth()\r\n    this.init()\r\n\r\n  },\r\n}\r\n<\/script>\r\n<style scoped>\r\n.ellipsis {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n.tree {\r\n  margin-left: 5%;\r\n}\r\n.treeRadio {\r\n  position: absolute;\r\n  left: 20%;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},d0ba:function(t,e,r){var n=r("7Wit");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);r("rjj0")("3900d836",n,!1,{})},sTZU:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("Xxa5"),a=r.n(n),i=r("woOf"),s=r.n(i),o=r("exGp"),d=r.n(o),c=(r("0xDb"),{data:function(){return{list:[],token:window.sessionStorage.getItem("bbytoken"),page:1,pageCount:1,curId:0,thCurId:0,seCurId:0,threeAuthList:[],authList:[],treeData:[]}},methods:{paging:function(t){this.page=t,this.init()},init:function(){var t=this;return d()(a.a.mark(function e(){var r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.post("admin/SystemSetup/filterList",{token:t.token});case 3:r=e.sent,(n=r.data.data).forEach(function(t){t.children.forEach(function(t){t.status||(t=s()(t,{status:2}))})}),t.treeData=n,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}},e,t,[[0,9]])}))()},radioChange:function(t,e){var r=this;1==e?this.$prompt("请输入滤芯补贴","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"请输入滤芯补贴",closeOnClickModal:!1,beforeClose:function(n,a,i){if("confirm"==n){var s=a.inputValue;r.filterSet(t.id,e,s,i())}else t.status=2,i()}}).then(function(){}).catch(function(){}):this.filterSet(t.id,e)},filterSet:function(t,e,r,n){var i=this;return d()(a.a.mark(function s(){var o;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.$axios.post("admin/SystemSetup/filterSet",{token:i.token,cid:t,status:e,money:r});case 3:1==(o=a.sent).data.code?(i.$message({message:o.data.msg,type:"success"}),i.init(),n&&n()):i.$message.error(o.data.msg),a.next=10;break;case 7:throw a.prev=7,a.t0=a.catch(0),a.t0;case 10:case"end":return a.stop()}},s,i,[[0,7]])}))()},Auth:function(){var t=this,e=this.$route.query.id;this.curId=e,this.$axios.post("admin/Auth/erAuth",{token:window.sessionStorage.getItem("bbytoken"),id:e}).then(function(e){if(1==e.data.code){for(var r=e.data.data,n=0;n<r.length;n++)r[n].son&&"滤芯设置"==r[n].name&&(t.seCurId=r[n].id,t.threeAuthList=r[n].son);t.authList=r}else t.$alert(e.data.msg,"提示",{type:"error"})}).catch(function(t){alert(t)})}},mounted:function(){this.Auth(),this.init()}}),l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ctbHead",t._l(t.authList,function(e){return r("router-link",{key:e.id,class:t.seCurId==e.id?"cur":"",attrs:{to:{path:e.action,query:{id:t.curId}},"v-key":e.id}},[t._v("\n      "+t._s(e.name)+"\n    ")])}),1),t._v(" "),r("div",{staticClass:"container"},[t._m(0),t._v(" "),r("el-tree",{staticClass:"tree",attrs:{data:t.treeData,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){e.node;var n=e.data;return r("span",{staticClass:"custom-tree-node"},[t._v("\n        "+t._s(n.name)+"\n        "),1!=n.level?r("span",{staticClass:"treeRadio"},[r("el-radio-group",{on:{change:function(e){return t.radioChange(n,e)}},model:{value:n.status,callback:function(e){t.$set(n,"status",e)},expression:"data.status"}},[r("el-radio",{attrs:{label:2}},[t._v("维修厂")]),t._v(" "),r("el-radio",{attrs:{label:1}},[t._v("供应商")])],1),t._v(" "),1==n.status?r("span",{staticStyle:{"margin-left":"20px"}},[t._v("\n            滤芯补贴 : "+t._s(n.money)+"元\n          ")]):t._e()],1):t._e()])}}])})],1)],1)};l._withStripped=!0;var u={render:l,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"quote"},[e("div",{staticClass:"quote-ele"},[e("i"),this._v("\n        滤芯设置\n      ")])])}]},p=u;var h=!1;var f=r("VU/8")(c,p,!1,function(t){h||r("d0ba")},"data-v-71e54e54",null);f.options.__file="src/pages/filterSetup/index.vue";e.default=f.exports}});
//# sourceMappingURL=90.dc23deca218509c3901a.js.map